./data/informatica/ETCOE/EEDW01/SrcFiles/dbenv_b.sh
bteq <<EOF
/*.RUN File = /apps/informatica/product/pc/bin/td_geedw_plp.mlbt; */
 .RUN File = /data/informatica/ETCOE/EEDW01/SrcFiles/td_plp.mlbt 
database GEEDW_PLP_BULK_V;


-------ST Event complete Structure Insert-----------------===================
DELETE FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST;

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT * FROM	(
SELECT DISTINCT

CASE WHEN T2SYSTEM.T2POSEIDONNUMBER IS NULL THEN T2SYSTEM.T2SPUNUMBER
ELSE  T2SYSTEM.T2POSEIDONNUMBER END AS SYSTEM_ID
,T2SYSTEM.T2SPUNAME AS SYSTEM_NM
,T2SYSTEM.T2SPUNAME AS PARENT_NM
, 0 AS LVL 
 ,CAST('Has System/Machine (has)' AS VARCHAR(30)) AS  REL_TYPE
 ,CAST(T2SYSTEM.T2SPUNAME  || ', ' || T2SYSTEM.REVISION || ', ' || T2SYSTEM.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
,CAST(T2SYSTEM.T2SPUNUMBER AS VARCHAR(275)) AS T2SPUNUMBER 
,CAST(T2SYSTEM.T2POSEIDONNUMBER AS VARCHAR(275)) AS T2POSEIDONNUMBER -- plant id
 ,CAST('' AS VARCHAR(275)) AS  SUBJECT
  ,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
 ,CAST('' AS VARCHAR(275)) AS  TEXTM
 ,T2SYSTEM.CREATIONDATE AS  CREATION_DATE
 ,CAST('' AS VARCHAR(275)) AS  REMARKM
 ,CAST('System/Machine' AS VARCHAR(30)) AS CLASS_NM
 ,CAST(T2SYSTEM.T2SERIALNUMBER AS VARCHAR(275))  AS T2SERIALNUMBER-- Serial No
 ,CAST(T2SYSTEM.T2STOREORDERNUMBER AS VARCHAR(275))  AS T2STOREORDERNUMBER -- Order No
 ,CAST(T2SYSTEM.T2SYSTEMCODE AS VARCHAR(275))  AS T2SYSTEMCODE  --System Code
 ,CAST(T2SYSTEM.REVISION AS VARCHAR(275))  AS   REV_INDEX
 ,T2SYSTEM.SEQUENCE 
 ,T2SYSTEM.PROJECTNAME 
 ,CAST(T2SYSTEM.LIFECYCLESTATE AS VARCHAR(275))  AS  LIFECYCLESTATE
 ,CAST(T2SYSTEM.FROZENINDICATOR AS VARCHAR(275))  AS FROZENINDICATOR
 ,CAST(T2SYSTEM.SUPERSEDED AS VARCHAR(275))  AS SUPERSEDED
 ,CAST(T2SYSTEM.OFFICIAL AS VARCHAR(275))  AS OFFICIAL
 ,CAST(T2SYSTEM.CHECKEDOUT  AS VARCHAR(275))  AS CHECKEDOUT
 ,CAST(T2SYSTEM.OWNERNAME AS VARCHAR(275))  AS OWNERNAME
 ,CAST(T2SYSTEM.CURDBNAME AS VARCHAR(275))  AS CURDBNAME
 ,CAST(T2SYSTEM.T2SECURITYSTATE AS VARCHAR(275))  AS T2SECURITYSTATE
 ,T2SYSTEM.OBID AS  CHILD_OBID
 ,CAST(T2SYSTEM.T2SPUNAME AS VARCHAR(275))  AS   CHILD_NAME
 ,CAST(T2SYSTEM.REVISION  AS VARCHAR(275))   AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
 ,CAST(T2SYSTEM.T2SPUNAME AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
  FROM  GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM T2SYSTEM
 ) a
WHERE 1=1 
AND T2SPUNUMBER IN 
(
SELECT DISTINCT B.T2SPUNUMBER
FROM GEEDW_PLP_BV.ASSETINFO A
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM B
ON (A.EQUIPMENT_SYS_ID=B.T2SPUNUMBER OR A.EQUIPMENT_SYS_ID=B.T2POSEIDONNUMBER)
where T2SYSTEMCODE LIKE '%ST%'
);
--Query2
-- System Machine to Event
INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2SYSTEM.T2SPUNAME AS PARENT_NM
,VT.LVL+1 AS LVL
,CAST('Has Events (has)' AS VARCHAR(30)) AS  REL_TYPE
,CAST(T5EVENT.T5EVENTID  || ', ' || T5EVENT.REVISION || ', ' || T5EVENT.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
,T5EVENT.T2SPUNUMBER
,T5EVENT.T5EVENTID-- EVENT id
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
,CAST('' AS VARCHAR(275)) AS  TEXTM
,T5EVENT.CREATIONDATE AS  CREATION_DATE
,CAST('' AS VARCHAR(275)) AS  REMARKM
,CAST('Event' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,T5EVENT.REVISION AS REV_INDEX
,T5EVENT.SEQUENCE 
,T5EVENT.PROJECTNAME 
,T5EVENT.LIFECYCLESTATE
,T5EVENT.FROZENINDICATOR
,T5EVENT.SUPERSEDED 
,T5EVENT.OFFICIAL
,T5EVENT.CHECKEDOUT 
,T5EVENT.OWNERNAME
,T5EVENT.CURDBNAME
,T5EVENT.T2SECURITYSTATE
,T5EVENT.OBID AS  CHILD_OBID
,T5EVENT.T5EVENTID AS  CHILD_NAME
,T5EVENT.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || T5EVENT.T5EVENTID AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST  VT
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM T2SYSTEM
ON VT.T2SPUNUMBER=T2SYSTEM.T2SPUNUMBER
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T5EVENT T5EVENT
ON T2SYSTEM.T2SPUNUMBER = T5EVENT.T2SPUNUMBER
WHERE VT.CLASS_NM='System/Machine'	;
--Query3
-- Event to FSI relation

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
	SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T5EVENT.T5EVENTID
,VT.LVL+1 AS LVL
	,CAST('Has FSI (exeBy)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(T2FSIDoc.T2FSIDOCNUMBER|| ', ' ||T2FSIDoc.REVISION|| ', ' ||T2FSIDoc.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
	,T2FSIDoc.T2SPUNUMBER
	,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) AS FSI_NO
	,T2FSIDoc.T2FSISUBJECT AS  SUBJECT
	,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
	,CAST('' AS VARCHAR(275)) AS  TEXTM
	,T2FSIDoc.CREATIONDATE AS  CREATION_DATE
	,T2FSIDoc.T2FSIINTERNALREMARK AS  REMARKM
	,CAST('FSI' AS VARCHAR(30)) AS CLASS_NM
	,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
	,T2FSIDoc.REVISION AS REV_INDEX
	,T2FSIDoc.SEQUENCE 
	,T2FSIDoc.PROJECTNAME AS RESP
	,T2FSIDoc.LIFECYCLESTATE
	,T2FSIDoc.FROZENINDICATOR
	,T2FSIDoc.SUPERSEDED 
	,T2FSIDoc.OFFICIAL
	,T2FSIDoc.CHECKEDOUT 
	,T2FSIDoc.OWNERNAME
	,T2FSIDoc.CURDBNAME
	,T2FSIDoc.T2SECURITYSTATE
	,T2FSIDoc.OBID AS  CHILD_OBID
	,T2FSIDoc.T2FSIDOCNUMBER AS  CHILD_NAME
	,T2FSIDoc.REVISION AS  CHILD_REV
	,T2FSIDoc.T2FSIKKSNUMBER AS FSI_KKS
	,CAST('' AS VARCHAR(275)) AS  QUANTITY
	,CAST('' AS VARCHAR(275)) AS  POSTXT
	,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
	,CAST('' AS VARCHAR(275)) AS  POSITIONNO
	,CAST('' AS VARCHAR(275)) AS  WEIGHT
	,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
	,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
	,CAST(VT.DFSORDER || '\' || T2FSIDoc.T2FSIDOCNUMBER AS VARCHAR(500))  AS   DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST  VT
					INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T5EVENT  T5EVENT
					ON VT.T2POSEIDONNUMBER=T5EVENT.T5EVENTID
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T5FSToEv  T5FSToEv
					ON T5EVENT.OBID = T5FSToEv.RIGHT1 AND T5FSToEv.CLASS1 = 'T2FSIDoc' AND T5FSToEv.CLASS2 = 'T5Event' AND VT.CLASS_NM = 'Event'	
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
					ON T5FSToEv.LEFT1=T2FSIDoc.OBID --AND T2FSIDoc.SUPERSEDED = '-'
					WHERE VT.CLASS_NM = 'Event';
--Query4
-- FSI  to Material


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)

SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
					,CAST('Needs Material (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2MATRL.T2MATRLNUMBER|| ', ' ||T2MATRL.REVISION|| ', ' ||T2MATRL.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2MATRL.T2MATRLNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
	,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM					
					,CAST('' AS VARCHAR(275)) AS  TEXTM
					,T2MATRL.CREATIONDATE AS  CREATION_DATE
					,T2MATRL.T2REMARK AS  REMARKM
					,CAST('Material' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2MATRL.REVISION AS REV_INDEX
					,T2MATRL.SEQUENCE 
					,T2MATRL.PROJECTNAME AS RESP
					,T2MATRL.LIFECYCLESTATE
					,T2MATRL.FROZENINDICATOR
					,T2MATRL.SUPERSEDED 
					,T2MATRL.OFFICIAL
					,T2MATRL.CHECKEDOUT 
					,T2MATRL.OWNERNAME
					,T2MATRL.CURDBNAME
					,T2MATRL.T2SECURITYSTATE
					,T2MATRL.OBID AS  CHILD_OBID
					,T2MATRL.T2MATRLNUMBER AS  CHILD_NAME
					,T2MATRL.REVISION AS  CHILD_REV
					,T2FSIDoc.T2FSIMATERIALNECESSARY AS  FSI_KKS
			         ,CAST('' AS VARCHAR(275)) AS  QUANTITY
					,CAST('' AS VARCHAR(275)) AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,CAST('' AS VARCHAR(275)) AS  WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2MATRL.T2MATRLNUMBER AS VARCHAR(500))  AS  DFSORDER,
					 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
					ON VT.CHILD_OBID=T2FSIDoc.OBID 
					INNER JOIN 		GEEDW_PLP_BULK_V.CDR_RPDM_T2FSTOMT FM 
					ON T2FSIDoc.OBID =FM.LEFT1 
					INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON FM.RIGHT1=T2MATRL.OBID 
		     	WHERE VT.CLASS_NM = 'FSI';

--Query5
-- Material	 to Part

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2ASSM.PARTNUMBER|| ', ' ||T2ASSM.REVISION|| ', ' ||T2ASSM.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2ASSM.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
				--	,T2ASSM.T2TEXTEN AS  TEXTM
				,CASE 
					WHEN T2ASSM.T2TEXTEN  IS NOT NULL THEN T2ASSM.T2TEXTEN
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS NOT NULL THEN  T2ASSM.T2TEXTDE 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS NOT NULL THEN  T2ASSM.T2TEXTPL
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS NOT NULL THEN T2ASSM.T2TEXTSV
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS NOT NULL THEN  T2ASSM.T2TEXTFR 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS NOT NULL THEN T2ASSM.T2TEXTIT
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS NOT NULL THEN  	T2ASSM.T2TEXTES				 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS NOT NULL THEN T2ASSM.T2TEXTRU
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS NOT NULL THEN 	T2ASSM.T2TEXTNO
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS NOT NULL THEN 	T2ASSM.T2TEXTPT
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS NOT NULL THEN 	T2ASSM.T2TEXTRO
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS NOT NULL THEN T2ASSM.T2TEXTCS
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS  NULL AND  T2ASSM.T2TEXTCN  IS NOT NULL THEN 	T2ASSM.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN T2ASSM.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS  NULL AND  T2ASSM.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T2ASSM.CREATIONDATE AS  CREATION_DATE
					,T2ASSM.T2REMARKEN AS  REMARKM
					,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2ASSM.REVISION AS REV_INDEX
					,T2ASSM.SEQUENCE 
					,T2ASSM.PROJECTNAME AS RESP
					,T2ASSM.LIFECYCLESTATE
					,T2ASSM.FROZENINDICATOR
					,T2ASSM.SUPERSEDED 
					,T2ASSM.OFFICIAL
					,T2ASSM.CHECKEDOUT 
					,T2ASSM.OWNERNAME
					,T2ASSM.CURDBNAME
					,T2ASSM.T2SECURITYSTATE
					,T2ASSM.OBID AS  CHILD_OBID
					,T2ASSM.PARTNUMBER AS  CHILD_NAME
					,T2ASSM.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
					 ,CAST(T2MTTOAL.QUANTITY AS INT) AS MATRL_QTY
			  --      , ASSMSTRC.QUANTITY AS  QUANTITY
					,ASSMSTRC.T2TEXT9X25EN  AS  POSTXT
				--	,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,T2ASSM.T2WEIGHTSTR  AS  WEIGHT
			--		,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
			,UPPER(SUBSTR(T2MTTOAL.UNITOFMEASURE,4,10)) AS MATRL_UOM
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2ASSM.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST  VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2ASSM T2ASSM
			ON   T2MTTOAL.RIGHT1= T2ASSM.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T2Assm'
LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
			ON T2ASSM.OBID = ASSMSTRC.LEFT1 AND ASSMSTRC.CLASS1='T2Assm'
		     	WHERE VT.CLASS_NM = 'Material';
--Query6
--MATERIAL TO ORDEER

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T3Order.T3ORDERNUMBER|| ', ' ||T3Order.REVISION|| ', ' ||T3Order.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T3Order.T3ORDERNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
					,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
				--	,T3Order.T2TEXTEN AS  TEXTM
					,CASE 
					WHEN T3Order.T2TEXTEN  IS NOT NULL THEN T3Order.T2TEXTEN
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS NOT NULL THEN  T3Order.T2TEXTDE 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS NOT NULL THEN  T3Order.T2TEXTPL
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS NOT NULL THEN T3Order.T2TEXTSV
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS NOT NULL THEN  T3Order.T2TEXTFR 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS NOT NULL THEN T3Order.T2TEXTIT
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS NOT NULL THEN  	T3Order.T2TEXTES				 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS NOT NULL THEN T3Order.T2TEXTRU
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS NOT NULL THEN 	T3Order.T2TEXTNO
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS NOT NULL THEN 	T3Order.T2TEXTPT
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS NOT NULL THEN 	T3Order.T2TEXTRO
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS NOT NULL THEN T3Order.T2TEXTCS
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS  NULL AND  T3Order.T2TEXTCN  IS NOT NULL THEN 	T3Order.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN T3Order.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS  NULL AND  T3Order.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T3Order.CREATIONDATE AS  CREATION_DATE
					,T3Order.T2REMARKEN AS  REMARKM
					,CAST('Order' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T3Order.REVISION AS REV_INDEX
					,T3Order.SEQUENCE 
					,T3Order.PROJECTNAME AS RESP
					,T3Order.LIFECYCLESTATE
					,T3Order.FROZENINDICATOR
					,T3Order.SUPERSEDED 
					,T3Order.OFFICIAL
					,T3Order.CHECKEDOUT 
					,T3Order.OWNERNAME
					,T3Order.CURDBNAME
					,T3Order.T2SECURITYSTATE
					,T3Order.OBID AS  CHILD_OBID
					,T3Order.T3ORDERNUMBER AS  CHILD_NAME
					,T3Order.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
			         ,CAST('' AS VARCHAR(275)) AS  QUANTITY
					,CAST('' AS VARCHAR(275)) AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,CAST('' AS VARCHAR(275)) AS  WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T3Order.T3ORDERNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST  VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T3Order T3Order
			ON   T2MTTOAL.RIGHT1= T3Order.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T3Order'
		     	WHERE VT.CLASS_NM = 'Material';
--Query7
-- Material	 to  ITPlan

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(ITPLAN.PARTNUMBER|| ', ' ||ITPLAN.REVISION|| ', ' ||ITPLAN.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,ITPLAN.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
				--	,ITPLAN.T2TEXTEN AS  TEXTM
				,CASE 
					WHEN ITPLAN.T2TEXTEN  IS NOT NULL THEN ITPLAN.T2TEXTEN
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS NOT NULL THEN  ITPLAN.T2TEXTDE 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS NOT NULL THEN  ITPLAN.T2TEXTPL
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS NOT NULL THEN ITPLAN.T2TEXTSV
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS NOT NULL THEN  ITPLAN.T2TEXTFR 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS NOT NULL THEN ITPLAN.T2TEXTIT
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS NOT NULL THEN  	ITPLAN.T2TEXTES				 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS NOT NULL THEN ITPLAN.T2TEXTRU
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS NOT NULL THEN 	ITPLAN.T2TEXTNO
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS NOT NULL THEN 	ITPLAN.T2TEXTPT
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS NOT NULL THEN 	ITPLAN.T2TEXTRO
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS NOT NULL THEN ITPLAN.T2TEXTCS
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS  NULL AND  ITPLAN.T2TEXTCN  IS NOT NULL THEN 	ITPLAN.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN ITPLAN.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS  NULL AND  ITPLAN.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,ITPLAN.CREATIONDATE AS  CREATION_DATE
					,ITPLAN.T2REMARKEN AS  REMARKM
					,CAST('ITPLAN' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,ITPLAN.REVISION AS REV_INDEX
					,ITPLAN.SEQUENCE 
					,ITPLAN.PROJECTNAME AS RESP
					,ITPLAN.LIFECYCLESTATE
					,ITPLAN.FROZENINDICATOR
					,ITPLAN.SUPERSEDED 
					,ITPLAN.OFFICIAL
					,ITPLAN.CHECKEDOUT 
					,ITPLAN.OWNERNAME
					,ITPLAN.CURDBNAME
					,ITPLAN.T2SECURITYSTATE
					,ITPLAN.OBID AS  CHILD_OBID
					,ITPLAN.PARTNUMBER AS  CHILD_NAME
					,ITPLAN.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
					,T2PTSTPL.T2TEXT9X25EN   AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || ITPLAN.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2TSTPLN  ITPLAN
		 			ON T2MTTOAL.RIGHT1=ITPLAN.OBID AND   T2MTTOAL.CLASS1='T2Matrl' --AND  T2MTTOAL.CLASS2='T2TstPln'
			LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ITEMREV ITEMREV		 
			ON		ITPLAN.OBID=ITEMREV.LEFT1 AND ITEMREV.CLASS1='T2TstPln'
			LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2TpMstr T2TpMstr
			ON T2TpMstr.OBID=ItemRev.LEFT1				    	
		LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2PTSTPL  T2PTSTPL		
		ON T2TpMstr.OBID=T2PTSTPL.RIGHT1	AND T2PTSTPL.CLASS2='T2TpMstr'
		     	WHERE VT.CLASS_NM = 'Material';
-- MATERIAL TO DOC


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)

SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2STRPUB.PARTNUMBER|| ', ' ||T2STRPUB.REVISION|| ', ' ||T2STRPUB.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2STRPUB.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
								,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
					--,T2STRPUB.T2TEXTEN AS  TEXTM
						,CASE 
					WHEN T2STRPUB.T2TEXTEN  IS NOT NULL THEN T2STRPUB.T2TEXTEN
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS NOT NULL THEN  T2STRPUB.T2TEXTDE 
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS NOT NULL THEN  T2STRPUB.T2TEXTPL
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS NOT NULL THEN T2STRPUB.T2TEXTSV
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS NOT NULL THEN  T2STRPUB.T2TEXTFR 
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS NOT NULL THEN T2STRPUB.T2TEXTIT
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS NOT NULL THEN  	T2STRPUB.T2TEXTES				 
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS NOT NULL THEN T2STRPUB.T2TEXTRU
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS NOT NULL THEN 	T2STRPUB.T2TEXTNO
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS NOT NULL THEN 	T2STRPUB.T2TEXTPT
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS  NULL  AND T2STRPUB.T2TEXTRO IS NOT NULL THEN 	T2STRPUB.T2TEXTRO
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS  NULL  AND T2STRPUB.T2TEXTRO IS  NULL AND 	T2STRPUB.T2TEXTCS IS NOT NULL THEN T2STRPUB.T2TEXTCS
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS  NULL  AND T2STRPUB.T2TEXTRO IS  NULL AND 	T2STRPUB.T2TEXTCS IS  NULL AND  T2STRPUB.T2TEXTCN  IS NOT NULL THEN 	T2STRPUB.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN T2STRPUB.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS  NULL  AND T2STRPUB.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS  NULL  AND T2STRPUB.T2TEXTRO IS  NULL AND 	T2STRPUB.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  T2STRPUB.T2TEXTEN  IS  NULL  AND T2STRPUB.T2TEXTDE  IS  NULL  AND   T2STRPUB.T2TEXTPL IS  NULL  AND T2STRPUB.T2TEXTSV IS  NULL AND   T2STRPUB.T2TEXTFR IS  NULL 
					AND T2STRPUB.T2TEXTIT IS  NULL AND  T2STRPUB.T2TEXTES IS  NULL  AND 	T2STRPUB.T2TEXTRU IS  NULL AND T2STRPUB.T2TEXTNO IS  NULL  
					AND T2STRPUB.T2TEXTPT IS  NULL  AND T2STRPUB.T2TEXTRO IS  NULL AND 	T2STRPUB.T2TEXTCS IS  NULL AND  T2STRPUB.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T2STRPUB.CREATIONDATE AS  CREATION_DATE
					,T2STRPUB.T2REMARKEN AS  REMARKM
					,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2STRPUB.REVISION AS REV_INDEX
					,T2STRPUB.SEQUENCE 
					,T2STRPUB.PROJECTNAME AS RESP
					,T2STRPUB.LIFECYCLESTATE
					,T2STRPUB.FROZENINDICATOR
					,T2STRPUB.SUPERSEDED 
					,T2STRPUB.OFFICIAL
					,T2STRPUB.CHECKEDOUT 
					,T2STRPUB.OWNERNAME
					,T2STRPUB.CURDBNAME
					,T2STRPUB.T2SECURITYSTATE
					,T2STRPUB.OBID AS  CHILD_OBID
					,T2STRPUB.PARTNUMBER AS  CHILD_NAME
					,T2STRPUB.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
						,CAST('' AS VARCHAR(275)) AS   POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2STRPUB.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2STRPUB  T2STRPUB
		 			ON T2MTTOAL.RIGHT1=T2STRPUB.OBID AND   T2MTTOAL.CLASS1='T2Matrl' --AND  T2MTTOAL.CLASS2='T2PubStd'
		     	WHERE VT.CLASS_NM = 'Material';	

--MATERIAL TO PRO ORDER

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T3PRDORD.T3ORDERNUMBER|| ', ' ||T3PRDORD.REVISION|| ', ' ||T3PRDORD.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T3PRDORD.T3ORDERNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
					--,T3PRDORD.T2TEXTEN AS  TEXTM
						,CASE 
					WHEN T3PRDORD.T2TEXTEN  IS NOT NULL THEN T3PRDORD.T2TEXTEN
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS NOT NULL THEN  T3PRDORD.T2TEXTDE 
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS NOT NULL THEN  T3PRDORD.T2TEXTPL
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS NOT NULL THEN T3PRDORD.T2TEXTSV
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS NOT NULL THEN  T3PRDORD.T2TEXTFR 
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS NOT NULL THEN T3PRDORD.T2TEXTIT
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS NOT NULL THEN  	T3PRDORD.T2TEXTES				 
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS NOT NULL THEN T3PRDORD.T2TEXTRU
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS NOT NULL THEN 	T3PRDORD.T2TEXTNO
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS NOT NULL THEN 	T3PRDORD.T2TEXTPT
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS  NULL  AND T3PRDORD.T2TEXTRO IS NOT NULL THEN 	T3PRDORD.T2TEXTRO
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS  NULL  AND T3PRDORD.T2TEXTRO IS  NULL AND 	T3PRDORD.T2TEXTCS IS NOT NULL THEN T3PRDORD.T2TEXTCS
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS  NULL  AND T3PRDORD.T2TEXTRO IS  NULL AND 	T3PRDORD.T2TEXTCS IS  NULL AND  T3PRDORD.T2TEXTCN  IS NOT NULL THEN 	T3PRDORD.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN T3PRDORD.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS  NULL  AND T3PRDORD.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS  NULL  AND T3PRDORD.T2TEXTRO IS  NULL AND 	T3PRDORD.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  T3PRDORD.T2TEXTEN  IS  NULL  AND T3PRDORD.T2TEXTDE  IS  NULL  AND   T3PRDORD.T2TEXTPL IS  NULL  AND T3PRDORD.T2TEXTSV IS  NULL AND   T3PRDORD.T2TEXTFR IS  NULL 
					AND T3PRDORD.T2TEXTIT IS  NULL AND  T3PRDORD.T2TEXTES IS  NULL  AND 	T3PRDORD.T2TEXTRU IS  NULL AND T3PRDORD.T2TEXTNO IS  NULL  
					AND T3PRDORD.T2TEXTPT IS  NULL  AND T3PRDORD.T2TEXTRO IS  NULL AND 	T3PRDORD.T2TEXTCS IS  NULL AND  T3PRDORD.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T3PRDORD.CREATIONDATE AS  CREATION_DATE
					,T3PRDORD.T2REMARKEN AS  REMARKM
					,CAST('Production Order' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T3PRDORD.REVISION AS REV_INDEX
					,T3PRDORD.SEQUENCE 
					,T3PRDORD.PROJECTNAME AS RESP
					,T3PRDORD.LIFECYCLESTATE
					,T3PRDORD.FROZENINDICATOR
					,T3PRDORD.SUPERSEDED 
					,T3PRDORD.OFFICIAL
					,T3PRDORD.CHECKEDOUT 
					,T3PRDORD.OWNERNAME
					,T3PRDORD.CURDBNAME
					,T3PRDORD.T2SECURITYSTATE
					,T3PRDORD.OBID AS  CHILD_OBID
					,T3PRDORD.T3ORDERNUMBER AS  CHILD_NAME
					,T3PRDORD.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
						,CAST('' AS VARCHAR(275)) AS   POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T3PRDORD.T3ORDERNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T3PRDORD T3PRDORD
		 			ON T2MTTOAL.RIGHT1=T3PRDORD.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T3PrdOrd'
		     	WHERE VT.CLASS_NM = 'Material';
-- FSI TO DOC

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Use Doc  (Use Doc)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN DOC.T2TEXTEN
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  DOC.T2TEXTDE 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  DOC.T2TEXTPL
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN DOC.T2TEXTSV
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  DOC.T2TEXTFR 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN DOC.T2TEXTIT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	DOC.T2TEXTES				 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN DOC.T2TEXTRU
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	DOC.T2TEXTNO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	DOC.T2TEXTPT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 	DOC.T2TEXTRO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN DOC.T2TEXTCS
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN  IS NOT NULL THEN 	DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD2 T2FSToD2
	ON T2FSIDoc.OBID =T2FSToD2.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD2.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
			WHERE VT.CLASS_NM = 'FSI';
--- FSI TO DOC

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Subassembly  (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN DOC.T2TEXTEN
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  DOC.T2TEXTDE 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  DOC.T2TEXTPL
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN DOC.T2TEXTSV
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  DOC.T2TEXTFR 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN DOC.T2TEXTIT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	DOC.T2TEXTES				 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN DOC.T2TEXTRU
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	DOC.T2TEXTNO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	DOC.T2TEXTPT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 	DOC.T2TEXTRO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN DOC.T2TEXTCS
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN  IS NOT NULL THEN 	DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
		INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD6 T2FSToD6
	ON T2FSIDoc.OBID =T2FSToD6.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD6.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';
--Query13
-- FSI to Has Component Doc

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Component (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN DOC.T2TEXTEN
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  DOC.T2TEXTDE 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  DOC.T2TEXTPL
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN DOC.T2TEXTSV
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  DOC.T2TEXTFR 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN DOC.T2TEXTIT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	DOC.T2TEXTES				 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN DOC.T2TEXTRU
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	DOC.T2TEXTNO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	DOC.T2TEXTPT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 	DOC.T2TEXTRO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN DOC.T2TEXTCS
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN  IS NOT NULL THEN 	DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD5 T2FSToD5
	ON T2FSIDoc.OBID =T2FSToD5.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD5.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';		     	    

--Query13
-- FSI to Has Feedback Doc


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Feedback (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN DOC.T2TEXTEN
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  DOC.T2TEXTDE 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  DOC.T2TEXTPL
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN DOC.T2TEXTSV
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  DOC.T2TEXTFR 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN DOC.T2TEXTIT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	DOC.T2TEXTES				 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN DOC.T2TEXTRU
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	DOC.T2TEXTNO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	DOC.T2TEXTPT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 	DOC.T2TEXTRO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN DOC.T2TEXTCS
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN  IS NOT NULL THEN 	DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD3 T2FSToD3
	ON T2FSIDoc.OBID =T2FSToD3.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD3.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';
--Query14
-- FSI to FSI Specific Doc


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('(I)FSI Specific Doc (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN DOC.T2TEXTEN
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  DOC.T2TEXTDE 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  DOC.T2TEXTPL
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN DOC.T2TEXTSV
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  DOC.T2TEXTFR 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN DOC.T2TEXTIT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	DOC.T2TEXTES				 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN DOC.T2TEXTRU
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	DOC.T2TEXTNO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	DOC.T2TEXTPT
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 	DOC.T2TEXTRO
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN DOC.T2TEXTCS
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN  IS NOT NULL THEN 	DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  DOC.T2TEXTEN  IS  NULL  AND DOC.T2TEXTDE  IS  NULL  AND   DOC.T2TEXTPL IS  NULL  AND DOC.T2TEXTSV IS  NULL AND   DOC.T2TEXTFR IS  NULL 
					AND DOC.T2TEXTIT IS  NULL AND  DOC.T2TEXTES IS  NULL  AND 	DOC.T2TEXTRU IS  NULL AND DOC.T2TEXTNO IS  NULL  
					AND DOC.T2TEXTPT IS  NULL  AND DOC.T2TEXTRO IS  NULL AND 	DOC.T2TEXTCS IS  NULL AND  DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToDc T2FSToDc
	ON T2FSIDoc.OBID =T2FSToDc.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToDc.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
			WHERE VT.CLASS_NM = 'FSI';
--Query15
-- FSI to Has Subassembly PART

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Subassembly (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(PART.PARTNUMBER || ',' || PART.REVISION || ',' || PART.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, PART.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,PART.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN PART.T2TEXTEN  IS NOT NULL THEN PART.T2TEXTEN
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS NOT NULL THEN  PART.T2TEXTDE 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS NOT NULL THEN  PART.T2TEXTPL
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS NOT NULL THEN PART.T2TEXTSV
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS NOT NULL THEN  PART.T2TEXTFR 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS NOT NULL THEN PART.T2TEXTIT
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS NOT NULL THEN  	PART.T2TEXTES				 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS NOT NULL THEN PART.T2TEXTRU
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS NOT NULL THEN 	PART.T2TEXTNO
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS NOT NULL THEN 	PART.T2TEXTPT
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS NOT NULL THEN 	PART.T2TEXTRO
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS NOT NULL THEN PART.T2TEXTCS
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS  NULL AND  PART.T2TEXTCN  IS NOT NULL THEN 	PART.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN PART.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS  NULL AND  PART.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,PART.CREATIONDATE AS  CREATION_DATE
,PART.T2REMARKEN AS  REMARKM
,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,PART.REVISION AS REV_INDEX
,PART.SEQUENCE 
,PART.PROJECTNAME 
,PART.LIFECYCLESTATE
,PART.FROZENINDICATOR
,PART.SUPERSEDED 
,PART.OFFICIAL
,PART.CHECKEDOUT 
,PART.OWNERNAME
,PART.CURDBNAME
,PART.T2SECURITYSTATE
,PART.OBID AS  CHILD_OBID
,PART.PARTNUMBER AS  CHILD_NAME
,PART.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,ASSMSTRC.QUANTITY AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,PART.T2WEIGHTSTR AS  WEIGHT
,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || PART.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToP6 T2FSToP6
	ON T2FSIDoc.OBID =T2FSToP6.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2Assm PART
	ON 	T2FSToP6.RIGHT1=PART.OBID --AND PART.SUPERSEDED = '-'
	LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
ON PART.OBID = ASSMSTRC.LEFT1
WHERE VT.CLASS_NM = 'FSI';

--Query16
-- FSI to Has Component PART
INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Component (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(PART.PARTNUMBER || ',' || PART.REVISION || ',' || PART.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, PART.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,PART.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN PART.T2TEXTEN  IS NOT NULL THEN PART.T2TEXTEN
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS NOT NULL THEN  PART.T2TEXTDE 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS NOT NULL THEN  PART.T2TEXTPL
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS NOT NULL THEN PART.T2TEXTSV
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS NOT NULL THEN  PART.T2TEXTFR 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS NOT NULL THEN PART.T2TEXTIT
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS NOT NULL THEN  	PART.T2TEXTES				 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS NOT NULL THEN PART.T2TEXTRU
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS NOT NULL THEN 	PART.T2TEXTNO
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS NOT NULL THEN 	PART.T2TEXTPT
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS NOT NULL THEN 	PART.T2TEXTRO
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS NOT NULL THEN PART.T2TEXTCS
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS  NULL AND  PART.T2TEXTCN  IS NOT NULL THEN 	PART.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN PART.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  PART.T2TEXTEN  IS  NULL  AND PART.T2TEXTDE  IS  NULL  AND   PART.T2TEXTPL IS  NULL  AND PART.T2TEXTSV IS  NULL AND   PART.T2TEXTFR IS  NULL 
					AND PART.T2TEXTIT IS  NULL AND  PART.T2TEXTES IS  NULL  AND 	PART.T2TEXTRU IS  NULL AND PART.T2TEXTNO IS  NULL  
					AND PART.T2TEXTPT IS  NULL  AND PART.T2TEXTRO IS  NULL AND 	PART.T2TEXTCS IS  NULL AND  PART.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,PART.CREATIONDATE AS  CREATION_DATE
,PART.T2REMARKEN AS  REMARKM
,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,PART.REVISION AS REV_INDEX
,PART.SEQUENCE 
,PART.PROJECTNAME 
,PART.LIFECYCLESTATE
,PART.FROZENINDICATOR
,PART.SUPERSEDED 
,PART.OFFICIAL
,PART.CHECKEDOUT 
,PART.OWNERNAME
,PART.CURDBNAME
,PART.T2SECURITYSTATE
,PART.OBID AS  CHILD_OBID
,PART.PARTNUMBER AS  CHILD_NAME
,PART.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,ASSMSTRC.QUANTITY AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,PART.T2WEIGHTSTR AS  WEIGHT
,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || PART.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToP5 T2FSToP5
	ON T2FSIDoc.OBID =T2FSToP5.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2Assm PART
	ON 	T2FSToP5.RIGHT1=PART.OBID --AND PART.SUPERSEDED = '-'
	LEFT OUTER JOIN  GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
ON PART.OBID = ASSMSTRC.LEFT1
WHERE VT.CLASS_NM = 'FSI';

--------------------------==================GT  Event Structure Query------------====================
DELETE FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT;

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT * FROM	(
SELECT DISTINCT

CASE WHEN T2SYSTEM.T2POSEIDONNUMBER IS NULL THEN T2SYSTEM.T2SPUNUMBER
ELSE  T2SYSTEM.T2POSEIDONNUMBER END AS SYSTEM_ID
,T2SYSTEM.T2SPUNAME AS SYSTEM_NM
,T2SYSTEM.T2SPUNAME AS PARENT_NM
, 0 AS LVL 
 ,CAST('Has System/Machine (has)' AS VARCHAR(30)) AS  REL_TYPE
 ,CAST(T2SYSTEM.T2SPUNAME  || ', ' || T2SYSTEM.REVISION || ', ' || T2SYSTEM.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
,CAST(T2SYSTEM.T2SPUNUMBER AS VARCHAR(275)) AS T2SPUNUMBER 
,CAST(T2SYSTEM.T2POSEIDONNUMBER AS VARCHAR(275)) AS T2POSEIDONNUMBER -- plant id
 ,CAST('' AS VARCHAR(275)) AS  SUBJECT
  ,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
 ,CAST('' AS VARCHAR(275)) AS  TEXTM
 ,T2SYSTEM.CREATIONDATE AS  CREATION_DATE
 ,CAST('' AS VARCHAR(275)) AS  REMARKM
 ,CAST('System/Machine' AS VARCHAR(30)) AS CLASS_NM
 ,CAST(T2SYSTEM.T2SERIALNUMBER AS VARCHAR(275))  AS T2SERIALNUMBER-- Serial No
 ,CAST(T2SYSTEM.T2STOREORDERNUMBER AS VARCHAR(275))  AS T2STOREORDERNUMBER -- Order No
 ,CAST(T2SYSTEM.T2SYSTEMCODE AS VARCHAR(275))  AS T2SYSTEMCODE  --System Code
 ,CAST(T2SYSTEM.REVISION AS VARCHAR(275))  AS   REV_INDEX
 ,T2SYSTEM.SEQUENCE 
 ,T2SYSTEM.PROJECTNAME 
 ,CAST(T2SYSTEM.LIFECYCLESTATE AS VARCHAR(275))  AS  LIFECYCLESTATE
 ,CAST(T2SYSTEM.FROZENINDICATOR AS VARCHAR(275))  AS FROZENINDICATOR
 ,CAST(T2SYSTEM.SUPERSEDED AS VARCHAR(275))  AS SUPERSEDED
 ,CAST(T2SYSTEM.OFFICIAL AS VARCHAR(275))  AS OFFICIAL
 ,CAST(T2SYSTEM.CHECKEDOUT  AS VARCHAR(275))  AS CHECKEDOUT
 ,CAST(T2SYSTEM.OWNERNAME AS VARCHAR(275))  AS OWNERNAME
 ,CAST(T2SYSTEM.CURDBNAME AS VARCHAR(275))  AS CURDBNAME
 ,CAST(T2SYSTEM.T2SECURITYSTATE AS VARCHAR(275))  AS T2SECURITYSTATE
 ,T2SYSTEM.OBID AS  CHILD_OBID
 ,CAST(T2SYSTEM.T2SPUNAME AS VARCHAR(275))  AS   CHILD_NAME
 ,CAST(T2SYSTEM.REVISION  AS VARCHAR(275))   AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
 ,CAST(T2SYSTEM.T2SPUNAME AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
  FROM  GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM T2SYSTEM
 ) a
WHERE 1=1 
AND T2SPUNUMBER IN 
(
SELECT DISTINCT B.T2SPUNUMBER
FROM GEEDW_PLP_BV.ASSETINFO A
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM B
ON (A.EQUIPMENT_SYS_ID=B.T2SPUNUMBER OR A.EQUIPMENT_SYS_ID=B.T2POSEIDONNUMBER)
where T2SYSTEMCODE LIKE '%GT%'
);
--Query2
-- System Machine to Event


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2SYSTEM.T2SPUNAME AS PARENT_NM
,VT.LVL+1 AS LVL
,CAST('Has Events (has)' AS VARCHAR(30)) AS  REL_TYPE
,CAST(T5EVENT.T5EVENTID|| ', ' || T5EVENT.REVISION || ', ' || T5EVENT.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
,T5EVENT.T2SPUNUMBER
,T5EVENT.T5EVENTID-- EVENT id
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
,CAST('' AS VARCHAR(275)) AS  TEXTM
,T5EVENT.CREATIONDATE AS  CREATION_DATE
,CAST('' AS VARCHAR(275)) AS  REMARKM
,CAST('Event' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,T5EVENT.REVISION AS REV_INDEX
,T5EVENT.SEQUENCE 
,T5EVENT.PROJECTNAME 
,T5EVENT.LIFECYCLESTATE
,T5EVENT.FROZENINDICATOR
,T5EVENT.SUPERSEDED 
,T5EVENT.OFFICIAL
,T5EVENT.CHECKEDOUT 
,T5EVENT.OWNERNAME
,T5EVENT.CURDBNAME
,T5EVENT.T2SECURITYSTATE
,T5EVENT.OBID AS  CHILD_OBID
,T5EVENT.T5EVENTID AS  CHILD_NAME
,T5EVENT.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || T5EVENT.T5EVENTID AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT  VT
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM T2SYSTEM
ON VT.T2SPUNUMBER=T2SYSTEM.T2SPUNUMBER
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T5EVENT T5EVENT
ON T2SYSTEM.T2SPUNUMBER = T5EVENT.T2SPUNUMBER
WHERE VT.CLASS_NM='System/Machine'	;
--Query3
-- Event to FSI relation


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
	SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T5EVENT.T5EVENTID
,VT.LVL+1 AS LVL
	,CAST('Has FSI (exeBy)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(T2FSIDoc.T2FSIDOCNUMBER|| ', ' ||T2FSIDoc.REVISION|| ', ' ||T2FSIDoc.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
	,T2FSIDoc.T2SPUNUMBER
	,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) AS FSI_NO
	,T2FSIDoc.T2FSISUBJECT AS  SUBJECT
	,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
	,CAST('' AS VARCHAR(275)) AS  TEXTM
	,T2FSIDoc.CREATIONDATE AS  CREATION_DATE
	,T2FSIDoc.T2FSIINTERNALREMARK AS  REMARKM
	,CAST('FSI' AS VARCHAR(30)) AS CLASS_NM
	,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
	,T2FSIDoc.REVISION AS REV_INDEX
	,T2FSIDoc.SEQUENCE 
	,T2FSIDoc.PROJECTNAME AS RESP
	,T2FSIDoc.LIFECYCLESTATE
	,T2FSIDoc.FROZENINDICATOR
	,T2FSIDoc.SUPERSEDED 
	,T2FSIDoc.OFFICIAL
	,T2FSIDoc.CHECKEDOUT 
	,T2FSIDoc.OWNERNAME
	,T2FSIDoc.CURDBNAME
	,T2FSIDoc.T2SECURITYSTATE
	,T2FSIDoc.OBID AS  CHILD_OBID
	,T2FSIDoc.T2FSIDOCNUMBER AS  CHILD_NAME
	,T2FSIDoc.REVISION AS  CHILD_REV
	,T2FSIDoc.T2FSIKKSNUMBER AS FSI_KKS
	,CAST('' AS VARCHAR(275)) AS  QUANTITY
	,CAST('' AS VARCHAR(275)) AS  POSTXT
	,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
	,CAST('' AS VARCHAR(275)) AS  POSITIONNO
	,CAST('' AS VARCHAR(275)) AS  WEIGHT
	,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
	,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
	,CAST(VT.DFSORDER || '\' || T2FSIDoc.T2FSIDOCNUMBER AS VARCHAR(500))  AS   DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT  VT
INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T5EVENT  T5EVENT
ON VT.T2POSEIDONNUMBER=T5EVENT.T5EVENTID
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T5FSToEv  T5FSToEv
ON T5EVENT.OBID = T5FSToEv.RIGHT1 AND T5FSToEv.CLASS1 = 'T2FSIDoc' AND T5FSToEv.CLASS2 = 'T5Event' AND VT.CLASS_NM = 'Event'	
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
ON T5FSToEv.LEFT1=T2FSIDoc.OBID --AND T2FSIDoc.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'Event';
--Query4
-- FSI  to Material


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)

SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
,CAST('Needs Material (has)' AS VARCHAR(30)) AS  REL_TYPE
,CAST(T2MATRL.T2MATRLNUMBER|| ', ' ||T2MATRL.REVISION|| ', ' ||T2MATRL.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2MATRL.T2MATRLNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
	,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM					
					,CAST('' AS VARCHAR(275)) AS  TEXTM
					,T2MATRL.CREATIONDATE AS  CREATION_DATE
					,T2MATRL.T2REMARK AS  REMARKM
					,CAST('Material' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2MATRL.REVISION AS REV_INDEX
					,T2MATRL.SEQUENCE 
					,T2MATRL.PROJECTNAME AS RESP
					,T2MATRL.LIFECYCLESTATE
					,T2MATRL.FROZENINDICATOR
					,T2MATRL.SUPERSEDED 
					,T2MATRL.OFFICIAL
					,T2MATRL.CHECKEDOUT 
					,T2MATRL.OWNERNAME
					,T2MATRL.CURDBNAME
					,T2MATRL.T2SECURITYSTATE
					,T2MATRL.OBID AS  CHILD_OBID
					,T2MATRL.T2MATRLNUMBER AS  CHILD_NAME
					,T2MATRL.REVISION AS  CHILD_REV
					,T2FSIDoc.T2FSIMATERIALNECESSARY AS  FSI_KKS
			         ,CAST('' AS VARCHAR(275)) AS  QUANTITY
					,CAST('' AS VARCHAR(275)) AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,CAST('' AS VARCHAR(275)) AS  WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2MATRL.T2MATRLNUMBER AS VARCHAR(500))  AS  DFSORDER,
					 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
			FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
					ON VT.CHILD_OBID=T2FSIDoc.OBID 
					INNER JOIN 		GEEDW_PLP_BULK_V.CDR_RPDM_T2FSTOMT FM 
					ON T2FSIDoc.OBID =FM.LEFT1 
					INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON FM.RIGHT1=T2MATRL.OBID 
		     	WHERE VT.CLASS_NM = 'FSI';

--Query5
-- Material	 to Part


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2ASSM.PARTNUMBER|| ', ' ||T2ASSM.REVISION|| ', ' ||T2ASSM.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2ASSM.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
				--	,T2ASSM.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN T2ASSM.T2TEXTEN  IS NOT NULL THEN T2ASSM.T2TEXTEN
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS NOT NULL THEN  T2ASSM.T2TEXTDE 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS NOT NULL THEN  T2ASSM.T2TEXTPL
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS NOT NULL THEN T2ASSM.T2TEXTSV
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS NOT NULL THEN  T2ASSM.T2TEXTFR 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS NOT NULL THEN T2ASSM.T2TEXTIT
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS NOT NULL THEN  	T2ASSM.T2TEXTES				 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS NOT NULL THEN T2ASSM.T2TEXTRU
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS NOT NULL THEN 	T2ASSM.T2TEXTNO
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS NOT NULL THEN 	T2ASSM.T2TEXTPT
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS NOT NULL THEN 	T2ASSM.T2TEXTRO
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS NOT NULL THEN T2ASSM.T2TEXTCS
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS  NULL AND  T2ASSM.T2TEXTCN  IS NOT NULL THEN 	T2ASSM.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN T2ASSM.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  T2ASSM.T2TEXTEN  IS  NULL  AND T2ASSM.T2TEXTDE  IS  NULL  AND   T2ASSM.T2TEXTPL IS  NULL  AND T2ASSM.T2TEXTSV IS  NULL AND   T2ASSM.T2TEXTFR IS  NULL 
					AND T2ASSM.T2TEXTIT IS  NULL AND  T2ASSM.T2TEXTES IS  NULL  AND 	T2ASSM.T2TEXTRU IS  NULL AND T2ASSM.T2TEXTNO IS  NULL  
					AND T2ASSM.T2TEXTPT IS  NULL  AND T2ASSM.T2TEXTRO IS  NULL AND 	T2ASSM.T2TEXTCS IS  NULL AND  T2ASSM.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE				
					,T2ASSM.CREATIONDATE AS  CREATION_DATE
					,T2ASSM.T2REMARKEN AS  REMARKM
					,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2ASSM.REVISION AS REV_INDEX
					,T2ASSM.SEQUENCE 
					,T2ASSM.PROJECTNAME AS RESP
					,T2ASSM.LIFECYCLESTATE
					,T2ASSM.FROZENINDICATOR
					,T2ASSM.SUPERSEDED 
					,T2ASSM.OFFICIAL
					,T2ASSM.CHECKEDOUT 
					,T2ASSM.OWNERNAME
					,T2ASSM.CURDBNAME
					,T2ASSM.T2SECURITYSTATE
					,T2ASSM.OBID AS  CHILD_OBID
					,T2ASSM.PARTNUMBER AS  CHILD_NAME
					,T2ASSM.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
					 ,CAST(T2MTTOAL.QUANTITY AS INT) AS MATRL_QTY
			  --      , ASSMSTRC.QUANTITY AS  QUANTITY
					,ASSMSTRC.T2TEXT9X25EN  AS  POSTXT
				--	,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,T2ASSM.T2WEIGHTSTR  AS  WEIGHT
			--		,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
			,UPPER(SUBSTR(T2MTTOAL.UNITOFMEASURE,4,10)) AS MATRL_UOM
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2ASSM.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT  VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2ASSM T2ASSM
			ON   T2MTTOAL.RIGHT1= T2ASSM.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T2Assm'
LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
			ON T2ASSM.OBID = ASSMSTRC.LEFT1 AND ASSMSTRC.CLASS1='T2Assm'
		     	WHERE VT.CLASS_NM = 'Material';
--Query6
--MATERIAL TO ORDEER

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T3Order.T3ORDERNUMBER|| ', ' ||T3Order.REVISION|| ', ' ||T3Order.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T3Order.T3ORDERNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
					,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T3Order.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN T3Order.T2TEXTEN  IS NOT NULL THEN T3Order.T2TEXTEN
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS NOT NULL THEN  T3Order.T2TEXTDE 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS NOT NULL THEN  T3Order.T2TEXTPL
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS NOT NULL THEN T3Order.T2TEXTSV
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS NOT NULL THEN  T3Order.T2TEXTFR 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS NOT NULL THEN T3Order.T2TEXTIT
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS NOT NULL THEN  	T3Order.T2TEXTES				 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS NOT NULL THEN T3Order.T2TEXTRU
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS NOT NULL THEN 	T3Order.T2TEXTNO
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS NOT NULL THEN 	T3Order.T2TEXTPT
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS NOT NULL THEN 	T3Order.T2TEXTRO
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS NOT NULL THEN T3Order.T2TEXTCS
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS  NULL AND  T3Order.T2TEXTCN  IS NOT NULL THEN 	T3Order.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN T3Order.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  T3Order.T2TEXTEN  IS  NULL  AND T3Order.T2TEXTDE  IS  NULL  AND   T3Order.T2TEXTPL IS  NULL  AND T3Order.T2TEXTSV IS  NULL AND   T3Order.T2TEXTFR IS  NULL 
					AND T3Order.T2TEXTIT IS  NULL AND  T3Order.T2TEXTES IS  NULL  AND 	T3Order.T2TEXTRU IS  NULL AND T3Order.T2TEXTNO IS  NULL  
					AND T3Order.T2TEXTPT IS  NULL  AND T3Order.T2TEXTRO IS  NULL AND 	T3Order.T2TEXTCS IS  NULL AND  T3Order.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T3Order.CREATIONDATE AS  CREATION_DATE
					,T3Order.T2REMARKEN AS  REMARKM
					,CAST('Order' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T3Order.REVISION AS REV_INDEX
					,T3Order.SEQUENCE 
					,T3Order.PROJECTNAME AS RESP
					,T3Order.LIFECYCLESTATE
					,T3Order.FROZENINDICATOR
					,T3Order.SUPERSEDED 
					,T3Order.OFFICIAL
					,T3Order.CHECKEDOUT 
					,T3Order.OWNERNAME
					,T3Order.CURDBNAME
					,T3Order.T2SECURITYSTATE
					,T3Order.OBID AS  CHILD_OBID
					,T3Order.T3ORDERNUMBER AS  CHILD_NAME
					,T3Order.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
			         ,CAST('' AS VARCHAR(275)) AS  QUANTITY
					,CAST('' AS VARCHAR(275)) AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,CAST('' AS VARCHAR(275)) AS  WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T3Order.T3ORDERNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT  VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T3Order T3Order
			ON   T2MTTOAL.RIGHT1= T3Order.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T3Order'
		     	WHERE VT.CLASS_NM = 'Material';
--Query7
-- Material	 to  ITPlan

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(ITPLAN.PARTNUMBER|| ', ' ||ITPLAN.REVISION|| ', ' ||ITPLAN.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,ITPLAN.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,ITPLAN.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN ITPLAN.T2TEXTEN  IS NOT NULL THEN ITPLAN.T2TEXTEN
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS NOT NULL THEN  ITPLAN.T2TEXTDE 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS NOT NULL THEN  ITPLAN.T2TEXTPL
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS NOT NULL THEN ITPLAN.T2TEXTSV
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS NOT NULL THEN  ITPLAN.T2TEXTFR 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS NOT NULL THEN ITPLAN.T2TEXTIT
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS NOT NULL THEN  	ITPLAN.T2TEXTES				 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS NOT NULL THEN ITPLAN.T2TEXTRU
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS NOT NULL THEN 	ITPLAN.T2TEXTNO
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS NOT NULL THEN 	ITPLAN.T2TEXTPT
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS NOT NULL THEN 	ITPLAN.T2TEXTRO
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS NOT NULL THEN ITPLAN.T2TEXTCS
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS  NULL AND  ITPLAN.T2TEXTCN  IS NOT NULL THEN 	ITPLAN.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN ITPLAN.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN  ITPLAN.T2TEXTEN  IS  NULL  AND ITPLAN.T2TEXTDE  IS  NULL  AND   ITPLAN.T2TEXTPL IS  NULL  AND ITPLAN.T2TEXTSV IS  NULL AND   ITPLAN.T2TEXTFR IS  NULL 
					AND ITPLAN.T2TEXTIT IS  NULL AND  ITPLAN.T2TEXTES IS  NULL  AND 	ITPLAN.T2TEXTRU IS  NULL AND ITPLAN.T2TEXTNO IS  NULL  
					AND ITPLAN.T2TEXTPT IS  NULL  AND ITPLAN.T2TEXTRO IS  NULL AND 	ITPLAN.T2TEXTCS IS  NULL AND  ITPLAN.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,ITPLAN.CREATIONDATE AS  CREATION_DATE
					,ITPLAN.T2REMARKEN AS  REMARKM
					,CAST('ITPLAN' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,ITPLAN.REVISION AS REV_INDEX
					,ITPLAN.SEQUENCE 
					,ITPLAN.PROJECTNAME AS RESP
					,ITPLAN.LIFECYCLESTATE
					,ITPLAN.FROZENINDICATOR
					,ITPLAN.SUPERSEDED 
					,ITPLAN.OFFICIAL
					,ITPLAN.CHECKEDOUT 
					,ITPLAN.OWNERNAME
					,ITPLAN.CURDBNAME
					,ITPLAN.T2SECURITYSTATE
					,ITPLAN.OBID AS  CHILD_OBID
					,ITPLAN.PARTNUMBER AS  CHILD_NAME
					,ITPLAN.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
					,T2PTSTPL.T2TEXT9X25EN   AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || ITPLAN.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2TSTPLN  ITPLAN
		 			ON T2MTTOAL.RIGHT1=ITPLAN.OBID AND   T2MTTOAL.CLASS1='T2Matrl' --AND  T2MTTOAL.CLASS2='T2TstPln'
			LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ITEMREV ITEMREV		 
			ON		ITPLAN.OBID=ITEMREV.LEFT1 AND ITEMREV.CLASS1='T2TstPln'
			LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2TpMstr T2TpMstr
			ON T2TpMstr.OBID=ItemRev.LEFT1				    	
		LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2PTSTPL  T2PTSTPL		
		ON T2TpMstr.OBID=T2PTSTPL.RIGHT1	AND T2PTSTPL.CLASS2='T2TpMstr'
		     	WHERE VT.CLASS_NM = 'Material';
-- MATERIAL TO DOC


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)

SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2STRPUB.PARTNUMBER|| ', ' ||T2STRPUB.REVISION|| ', ' ||T2STRPUB.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2STRPUB.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
								,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T2STRPUB.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  T2STRPUB.T2TEXTEN  IS NOT NULL THEN  T2STRPUB.T2TEXTEN
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS NOT NULL THEN   T2STRPUB.T2TEXTDE 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS NOT NULL THEN   T2STRPUB.T2TEXTPL
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS NOT NULL THEN  T2STRPUB.T2TEXTSV
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS NOT NULL THEN   T2STRPUB.T2TEXTFR 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS NOT NULL THEN  T2STRPUB.T2TEXTIT
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS NOT NULL THEN  	 T2STRPUB.T2TEXTES				 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS NOT NULL THEN  T2STRPUB.T2TEXTRU
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS NOT NULL THEN 	 T2STRPUB.T2TEXTNO
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS NOT NULL THEN 	 T2STRPUB.T2TEXTPT
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS NOT NULL THEN 	 T2STRPUB.T2TEXTRO
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS NOT NULL THEN  T2STRPUB.T2TEXTCS
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS  NULL AND   T2STRPUB.T2TEXTCN  IS NOT NULL THEN 	 T2STRPUB.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  T2STRPUB.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS  NULL AND   T2STRPUB.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T2STRPUB.CREATIONDATE AS  CREATION_DATE
					,T2STRPUB.T2REMARKEN AS  REMARKM
					,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2STRPUB.REVISION AS REV_INDEX
					,T2STRPUB.SEQUENCE 
					,T2STRPUB.PROJECTNAME AS RESP
					,T2STRPUB.LIFECYCLESTATE
					,T2STRPUB.FROZENINDICATOR
					,T2STRPUB.SUPERSEDED 
					,T2STRPUB.OFFICIAL
					,T2STRPUB.CHECKEDOUT 
					,T2STRPUB.OWNERNAME
					,T2STRPUB.CURDBNAME
					,T2STRPUB.T2SECURITYSTATE
					,T2STRPUB.OBID AS  CHILD_OBID
					,T2STRPUB.PARTNUMBER AS  CHILD_NAME
					,T2STRPUB.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
						,CAST('' AS VARCHAR(275)) AS   POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2STRPUB.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2STRPUB  T2STRPUB
		 			ON T2MTTOAL.RIGHT1=T2STRPUB.OBID AND   T2MTTOAL.CLASS1='T2Matrl' --AND  T2MTTOAL.CLASS2='T2PubStd'
		     	WHERE VT.CLASS_NM = 'Material';	

--MATERIAL TO PRO ORDER

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T3PRDORD.T3ORDERNUMBER|| ', ' ||T3PRDORD.REVISION|| ', ' ||T3PRDORD.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T3PRDORD.T3ORDERNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T3PRDORD.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  T3PRDORD.T2TEXTEN  IS NOT NULL THEN  T3PRDORD.T2TEXTEN
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS NOT NULL THEN   T3PRDORD.T2TEXTDE 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS NOT NULL THEN   T3PRDORD.T2TEXTPL
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS NOT NULL THEN  T3PRDORD.T2TEXTSV
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS NOT NULL THEN   T3PRDORD.T2TEXTFR 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS NOT NULL THEN  T3PRDORD.T2TEXTIT
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS NOT NULL THEN  	 T3PRDORD.T2TEXTES				 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS NOT NULL THEN  T3PRDORD.T2TEXTRU
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS NOT NULL THEN 	 T3PRDORD.T2TEXTNO
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS NOT NULL THEN 	 T3PRDORD.T2TEXTPT
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS NOT NULL THEN 	 T3PRDORD.T2TEXTRO
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS NOT NULL THEN  T3PRDORD.T2TEXTCS
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS  NULL AND   T3PRDORD.T2TEXTCN  IS NOT NULL THEN 	 T3PRDORD.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  T3PRDORD.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS  NULL AND   T3PRDORD.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T3PRDORD.CREATIONDATE AS  CREATION_DATE
					,T3PRDORD.T2REMARKEN AS  REMARKM
					,CAST('Production Order' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T3PRDORD.REVISION AS REV_INDEX
					,T3PRDORD.SEQUENCE 
					,T3PRDORD.PROJECTNAME AS RESP
					,T3PRDORD.LIFECYCLESTATE
					,T3PRDORD.FROZENINDICATOR
					,T3PRDORD.SUPERSEDED 
					,T3PRDORD.OFFICIAL
					,T3PRDORD.CHECKEDOUT 
					,T3PRDORD.OWNERNAME
					,T3PRDORD.CURDBNAME
					,T3PRDORD.T2SECURITYSTATE
					,T3PRDORD.OBID AS  CHILD_OBID
					,T3PRDORD.T3ORDERNUMBER AS  CHILD_NAME
					,T3PRDORD.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
						,CAST('' AS VARCHAR(275)) AS   POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T3PRDORD.T3ORDERNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T3PRDORD T3PRDORD
		 			ON T2MTTOAL.RIGHT1=T3PRDORD.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T3PrdOrd'
		     	WHERE VT.CLASS_NM = 'Material';
-- FSI TO DOC

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Use Doc  (Use Doc)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD2 T2FSToD2
	ON T2FSIDoc.OBID =T2FSToD2.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD2.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
			WHERE VT.CLASS_NM = 'FSI';
--- FSI TO DOC

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Subassembly  (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
		INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD6 T2FSToD6
	ON T2FSIDoc.OBID =T2FSToD6.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD6.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';
--Query13
-- FSI to Has Component Doc

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Component (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD5 T2FSToD5
	ON T2FSIDoc.OBID =T2FSToD5.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD5.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';		     	    

--Query13
-- FSI to Has Feedback Doc


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Feedback (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD3 T2FSToD3
	ON T2FSIDoc.OBID =T2FSToD3.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD3.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';
--Query14
-- FSI to FSI Specific Doc


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('(I)FSI Specific Doc (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToDc T2FSToDc
	ON T2FSIDoc.OBID =T2FSToDc.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToDc.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
			WHERE VT.CLASS_NM = 'FSI';
--Query15
-- FSI to Has Subassembly PART

INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Subassembly (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(PART.PARTNUMBER || ',' || PART.REVISION || ',' || PART.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, PART.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,PART.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN  PART.T2TEXTEN
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN   PART.T2TEXTDE 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN   PART.T2TEXTPL
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN  PART.T2TEXTSV
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN   PART.T2TEXTFR 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN  PART.T2TEXTIT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	 PART.T2TEXTES				 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN  PART.T2TEXTRU
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	 PART.T2TEXTNO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	 PART.T2TEXTPT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 	 PART.T2TEXTRO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN  PART.T2TEXTCS
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN  IS NOT NULL THEN 	 PART.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,PART.CREATIONDATE AS  CREATION_DATE
,PART.T2REMARKEN AS  REMARKM
,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,PART.REVISION AS REV_INDEX
,PART.SEQUENCE 
,PART.PROJECTNAME 
,PART.LIFECYCLESTATE
,PART.FROZENINDICATOR
,PART.SUPERSEDED 
,PART.OFFICIAL
,PART.CHECKEDOUT 
,PART.OWNERNAME
,PART.CURDBNAME
,PART.T2SECURITYSTATE
,PART.OBID AS  CHILD_OBID
,PART.PARTNUMBER AS  CHILD_NAME
,PART.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,ASSMSTRC.QUANTITY AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,PART.T2WEIGHTSTR AS  WEIGHT
,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || PART.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToP6 T2FSToP6
	ON T2FSIDoc.OBID =T2FSToP6.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2Assm PART
	ON 	T2FSToP6.RIGHT1=PART.OBID --AND PART.SUPERSEDED = '-'
	LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
ON PART.OBID = ASSMSTRC.LEFT1
WHERE VT.CLASS_NM = 'FSI';

--Query16
-- FSI to Has Component PART


INSERT INTO  GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Component (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(PART.PARTNUMBER || ',' || PART.REVISION || ',' || PART.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, PART.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,PART.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN  PART.T2TEXTEN
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN   PART.T2TEXTDE 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN   PART.T2TEXTPL
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN  PART.T2TEXTSV
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN   PART.T2TEXTFR 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN  PART.T2TEXTIT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	 PART.T2TEXTES				 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN  PART.T2TEXTRU
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	 PART.T2TEXTNO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	 PART.T2TEXTPT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 	 PART.T2TEXTRO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN  PART.T2TEXTCS
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN  IS NOT NULL THEN 	 PART.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,PART.CREATIONDATE AS  CREATION_DATE
,PART.T2REMARKEN AS  REMARKM
,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,PART.REVISION AS REV_INDEX
,PART.SEQUENCE 
,PART.PROJECTNAME 
,PART.LIFECYCLESTATE
,PART.FROZENINDICATOR
,PART.SUPERSEDED 
,PART.OFFICIAL
,PART.CHECKEDOUT 
,PART.OWNERNAME
,PART.CURDBNAME
,PART.T2SECURITYSTATE
,PART.OBID AS  CHILD_OBID
,PART.PARTNUMBER AS  CHILD_NAME
,PART.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,ASSMSTRC.QUANTITY AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,PART.T2WEIGHTSTR AS  WEIGHT
,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || PART.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM      GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToP5 T2FSToP5
	ON T2FSIDoc.OBID =T2FSToP5.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2Assm PART
	ON 	T2FSToP5.RIGHT1=PART.OBID --AND PART.SUPERSEDED = '-'
	LEFT OUTER JOIN  GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
ON PART.OBID = ASSMSTRC.LEFT1
WHERE VT.CLASS_NM = 'FSI';

----------------====================TG Event Structure Query--==========================
DELETE FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG;

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT * FROM	(
SELECT DISTINCT

CASE WHEN T2SYSTEM.T2POSEIDONNUMBER IS NULL THEN T2SYSTEM.T2SPUNUMBER
ELSE  T2SYSTEM.T2POSEIDONNUMBER END AS SYSTEM_ID
,T2SYSTEM.T2SPUNAME AS SYSTEM_NM
,T2SYSTEM.T2SPUNAME AS PARENT_NM
, 0 AS LVL 
 ,CAST('Has System/Machine (has)' AS VARCHAR(30)) AS  REL_TYPE
 ,CAST(T2SYSTEM.T2SPUNAME  || ', ' || T2SYSTEM.REVISION || ', ' || T2SYSTEM.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
,CAST(T2SYSTEM.T2SPUNUMBER AS VARCHAR(275)) AS T2SPUNUMBER 
,CAST(T2SYSTEM.T2POSEIDONNUMBER AS VARCHAR(275)) AS T2POSEIDONNUMBER -- plant id
 ,CAST('' AS VARCHAR(275)) AS  SUBJECT
  ,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
 ,CAST('' AS VARCHAR(275)) AS  TEXTM
 ,T2SYSTEM.CREATIONDATE AS  CREATION_DATE
 ,CAST('' AS VARCHAR(275)) AS  REMARKM
 ,CAST('System/Machine' AS VARCHAR(30)) AS CLASS_NM
 ,CAST(T2SYSTEM.T2SERIALNUMBER AS VARCHAR(275))  AS T2SERIALNUMBER-- Serial No
 ,CAST(T2SYSTEM.T2STOREORDERNUMBER AS VARCHAR(275))  AS T2STOREORDERNUMBER -- Order No
 ,CAST(T2SYSTEM.T2SYSTEMCODE AS VARCHAR(275))  AS T2SYSTEMCODE  --System Code
 ,CAST(T2SYSTEM.REVISION AS VARCHAR(275))  AS   REV_INDEX
 ,T2SYSTEM.SEQUENCE 
 ,T2SYSTEM.PROJECTNAME 
 ,CAST(T2SYSTEM.LIFECYCLESTATE AS VARCHAR(275))  AS  LIFECYCLESTATE
 ,CAST(T2SYSTEM.FROZENINDICATOR AS VARCHAR(275))  AS FROZENINDICATOR
 ,CAST(T2SYSTEM.SUPERSEDED AS VARCHAR(275))  AS SUPERSEDED
 ,CAST(T2SYSTEM.OFFICIAL AS VARCHAR(275))  AS OFFICIAL
 ,CAST(T2SYSTEM.CHECKEDOUT  AS VARCHAR(275))  AS CHECKEDOUT
 ,CAST(T2SYSTEM.OWNERNAME AS VARCHAR(275))  AS OWNERNAME
 ,CAST(T2SYSTEM.CURDBNAME AS VARCHAR(275))  AS CURDBNAME
 ,CAST(T2SYSTEM.T2SECURITYSTATE AS VARCHAR(275))  AS T2SECURITYSTATE
 ,T2SYSTEM.OBID AS  CHILD_OBID
 ,CAST(T2SYSTEM.T2SPUNAME AS VARCHAR(275))  AS   CHILD_NAME
 ,CAST(T2SYSTEM.REVISION  AS VARCHAR(275))   AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
 ,CAST(T2SYSTEM.T2SPUNAME AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
  FROM  GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM T2SYSTEM
 ) a
WHERE 1=1 
AND T2SPUNUMBER IN 
(
SELECT DISTINCT B.T2SPUNUMBER
FROM GEEDW_PLP_BV.ASSETINFO A
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM B
ON (A.EQUIPMENT_SYS_ID=B.T2SPUNUMBER OR A.EQUIPMENT_SYS_ID=B.T2POSEIDONNUMBER)
where T2SYSTEMCODE LIKE '%TG%'
);
--Query2
-- System Machine to Event


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2SYSTEM.T2SPUNAME AS PARENT_NM
,VT.LVL+1 AS LVL
,CAST('Has Events (has)' AS VARCHAR(30)) AS  REL_TYPE
,CAST(T5EVENT.T5EVENTID || ', ' || T5EVENT.REVISION || ', ' || T5EVENT.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
,T5EVENT.T2SPUNUMBER
,T5EVENT.T5EVENTID-- EVENT id
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
,CAST('' AS VARCHAR(275)) AS  TEXTM
,T5EVENT.CREATIONDATE AS  CREATION_DATE
,CAST('' AS VARCHAR(275)) AS  REMARKM
,CAST('Event' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,T5EVENT.REVISION AS REV_INDEX
,T5EVENT.SEQUENCE 
,T5EVENT.PROJECTNAME 
,T5EVENT.LIFECYCLESTATE
,T5EVENT.FROZENINDICATOR
,T5EVENT.SUPERSEDED 
,T5EVENT.OFFICIAL
,T5EVENT.CHECKEDOUT 
,T5EVENT.OWNERNAME
,T5EVENT.CURDBNAME
,T5EVENT.T2SECURITYSTATE
,T5EVENT.OBID AS  CHILD_OBID
,T5EVENT.T5EVENTID AS  CHILD_NAME
,T5EVENT.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || T5EVENT.T5EVENTID AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG  VT
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2SYSTEM T2SYSTEM
ON VT.T2SPUNUMBER=T2SYSTEM.T2SPUNUMBER
INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T5EVENT T5EVENT
ON T2SYSTEM.T2SPUNUMBER = T5EVENT.T2SPUNUMBER
WHERE VT.CLASS_NM='System/Machine'	;
--Query3
-- Event to FSI relation


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
	SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T5EVENT.T5EVENTID
,VT.LVL+1 AS LVL
	,CAST('Has FSI (exeBy)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(T2FSIDoc.T2FSIDOCNUMBER|| ', ' ||T2FSIDoc.REVISION|| ', ' ||T2FSIDoc.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
	,T2FSIDoc.T2SPUNUMBER
	,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) AS FSI_NO
	,T2FSIDoc.T2FSISUBJECT AS  SUBJECT
	,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
	,CAST('' AS VARCHAR(275)) AS  TEXTM
	,T2FSIDoc.CREATIONDATE AS  CREATION_DATE
	,T2FSIDoc.T2FSIINTERNALREMARK AS  REMARKM
	,CAST('FSI' AS VARCHAR(30)) AS CLASS_NM
	,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
	,T2FSIDoc.REVISION AS REV_INDEX
	,T2FSIDoc.SEQUENCE 
	,T2FSIDoc.PROJECTNAME AS RESP
	,T2FSIDoc.LIFECYCLESTATE
	,T2FSIDoc.FROZENINDICATOR
	,T2FSIDoc.SUPERSEDED 
	,T2FSIDoc.OFFICIAL
	,T2FSIDoc.CHECKEDOUT 
	,T2FSIDoc.OWNERNAME
	,T2FSIDoc.CURDBNAME
	,T2FSIDoc.T2SECURITYSTATE
	,T2FSIDoc.OBID AS  CHILD_OBID
	,T2FSIDoc.T2FSIDOCNUMBER AS  CHILD_NAME
	,T2FSIDoc.REVISION AS  CHILD_REV
	,T2FSIDoc.T2FSIKKSNUMBER AS FSI_KKS
	,CAST('' AS VARCHAR(275)) AS  QUANTITY
	,CAST('' AS VARCHAR(275)) AS  POSTXT
	,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
	,CAST('' AS VARCHAR(275)) AS  POSITIONNO
	,CAST('' AS VARCHAR(275)) AS  WEIGHT
	,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
	,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
	,CAST(VT.DFSORDER || '\' || T2FSIDoc.T2FSIDOCNUMBER AS VARCHAR(500))  AS   DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG  VT
					INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T5EVENT  T5EVENT
					ON VT.T2POSEIDONNUMBER=T5EVENT.T5EVENTID
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T5FSToEv  T5FSToEv
					ON T5EVENT.OBID = T5FSToEv.RIGHT1 AND T5FSToEv.CLASS1 = 'T2FSIDoc' AND T5FSToEv.CLASS2 = 'T5Event' AND VT.CLASS_NM = 'Event'	
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
					ON T5FSToEv.LEFT1=T2FSIDoc.OBID --AND T2FSIDoc.SUPERSEDED = '-'
					WHERE VT.CLASS_NM = 'Event';
--Query4
-- FSI  to Material

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)

SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
					,CAST('Needs Material (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2MATRL.T2MATRLNUMBER|| ', ' ||T2MATRL.REVISION|| ', ' ||T2MATRL.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2MATRL.T2MATRLNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
	,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM					
					,CAST('' AS VARCHAR(275)) AS  TEXTM
					,T2MATRL.CREATIONDATE AS  CREATION_DATE
					,T2MATRL.T2REMARK AS  REMARKM
					,CAST('Material' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2MATRL.REVISION AS REV_INDEX
					,T2MATRL.SEQUENCE 
					,T2MATRL.PROJECTNAME AS RESP
					,T2MATRL.LIFECYCLESTATE
					,T2MATRL.FROZENINDICATOR
					,T2MATRL.SUPERSEDED 
					,T2MATRL.OFFICIAL
					,T2MATRL.CHECKEDOUT 
					,T2MATRL.OWNERNAME
					,T2MATRL.CURDBNAME
					,T2MATRL.T2SECURITYSTATE
					,T2MATRL.OBID AS  CHILD_OBID
					,T2MATRL.T2MATRLNUMBER AS  CHILD_NAME
					,T2MATRL.REVISION AS  CHILD_REV
					,T2FSIDoc.T2FSIMATERIALNECESSARY AS  FSI_KKS
			         ,CAST('' AS VARCHAR(275)) AS  QUANTITY
					,CAST('' AS VARCHAR(275)) AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,CAST('' AS VARCHAR(275)) AS  WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2MATRL.T2MATRLNUMBER AS VARCHAR(500))  AS  DFSORDER,
					 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
					INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
					ON VT.CHILD_OBID=T2FSIDoc.OBID 
					INNER JOIN 		GEEDW_PLP_BULK_V.CDR_RPDM_T2FSTOMT FM 
					ON T2FSIDoc.OBID =FM.LEFT1 
					INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON FM.RIGHT1=T2MATRL.OBID 
		     	WHERE VT.CLASS_NM = 'FSI';

--Query5
-- Material	 to Part


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2ASSM.PARTNUMBER|| ', ' ||T2ASSM.REVISION|| ', ' ||T2ASSM.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2ASSM.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T2ASSM.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  T2ASSM.T2TEXTEN  IS NOT NULL THEN  T2ASSM.T2TEXTEN
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS NOT NULL THEN   T2ASSM.T2TEXTDE 
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS NOT NULL THEN   T2ASSM.T2TEXTPL
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS NOT NULL THEN  T2ASSM.T2TEXTSV
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS NOT NULL THEN   T2ASSM.T2TEXTFR 
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS NOT NULL THEN  T2ASSM.T2TEXTIT
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS NOT NULL THEN  	 T2ASSM.T2TEXTES				 
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS NOT NULL THEN  T2ASSM.T2TEXTRU
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS NOT NULL THEN 	 T2ASSM.T2TEXTNO
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS NOT NULL THEN 	 T2ASSM.T2TEXTPT
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS  NULL  AND  T2ASSM.T2TEXTRO IS NOT NULL THEN 	 T2ASSM.T2TEXTRO
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS  NULL  AND  T2ASSM.T2TEXTRO IS  NULL AND 	 T2ASSM.T2TEXTCS IS NOT NULL THEN  T2ASSM.T2TEXTCS
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS  NULL  AND  T2ASSM.T2TEXTRO IS  NULL AND 	 T2ASSM.T2TEXTCS IS  NULL AND   T2ASSM.T2TEXTCN  IS NOT NULL THEN 	 T2ASSM.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  T2ASSM.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS  NULL  AND  T2ASSM.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS  NULL  AND  T2ASSM.T2TEXTRO IS  NULL AND 	 T2ASSM.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   T2ASSM.T2TEXTEN  IS  NULL  AND  T2ASSM.T2TEXTDE  IS  NULL  AND    T2ASSM.T2TEXTPL IS  NULL  AND  T2ASSM.T2TEXTSV IS  NULL AND    T2ASSM.T2TEXTFR IS  NULL 
					AND  T2ASSM.T2TEXTIT IS  NULL AND   T2ASSM.T2TEXTES IS  NULL  AND 	 T2ASSM.T2TEXTRU IS  NULL AND  T2ASSM.T2TEXTNO IS  NULL  
					AND  T2ASSM.T2TEXTPT IS  NULL  AND  T2ASSM.T2TEXTRO IS  NULL AND 	 T2ASSM.T2TEXTCS IS  NULL AND   T2ASSM.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T2ASSM.CREATIONDATE AS  CREATION_DATE
					,T2ASSM.T2REMARKEN AS  REMARKM
					,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2ASSM.REVISION AS REV_INDEX
					,T2ASSM.SEQUENCE 
					,T2ASSM.PROJECTNAME AS RESP
					,T2ASSM.LIFECYCLESTATE
					,T2ASSM.FROZENINDICATOR
					,T2ASSM.SUPERSEDED 
					,T2ASSM.OFFICIAL
					,T2ASSM.CHECKEDOUT 
					,T2ASSM.OWNERNAME
					,T2ASSM.CURDBNAME
					,T2ASSM.T2SECURITYSTATE
					,T2ASSM.OBID AS  CHILD_OBID
					,T2ASSM.PARTNUMBER AS  CHILD_NAME
					,T2ASSM.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
					 ,CAST(T2MTTOAL.QUANTITY AS INT) AS MATRL_QTY
			  --      , ASSMSTRC.QUANTITY AS  QUANTITY
					,ASSMSTRC.T2TEXT9X25EN  AS  POSTXT
				--	,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,T2ASSM.T2WEIGHTSTR  AS  WEIGHT
			--		,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
			,UPPER(SUBSTR(T2MTTOAL.UNITOFMEASURE,4,10)) AS MATRL_UOM
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2ASSM.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG  VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2ASSM T2ASSM
			ON   T2MTTOAL.RIGHT1= T2ASSM.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T2Assm'
LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
			ON T2ASSM.OBID = ASSMSTRC.LEFT1 AND ASSMSTRC.CLASS1='T2Assm'
		     	WHERE VT.CLASS_NM = 'Material';
--Query6
--MATERIAL TO ORDEER

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T3Order.T3ORDERNUMBER|| ', ' ||T3Order.REVISION|| ', ' ||T3Order.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T3Order.T3ORDERNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
					,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T3Order.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  T3Order.T2TEXTEN  IS NOT NULL THEN  T3Order.T2TEXTEN
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS NOT NULL THEN   T3Order.T2TEXTDE 
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS NOT NULL THEN   T3Order.T2TEXTPL
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS NOT NULL THEN  T3Order.T2TEXTSV
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS NOT NULL THEN   T3Order.T2TEXTFR 
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS NOT NULL THEN  T3Order.T2TEXTIT
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS NOT NULL THEN  	 T3Order.T2TEXTES				 
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS NOT NULL THEN  T3Order.T2TEXTRU
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS NOT NULL THEN 	 T3Order.T2TEXTNO
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS NOT NULL THEN 	 T3Order.T2TEXTPT
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS  NULL  AND  T3Order.T2TEXTRO IS NOT NULL THEN 	 T3Order.T2TEXTRO
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS  NULL  AND  T3Order.T2TEXTRO IS  NULL AND 	 T3Order.T2TEXTCS IS NOT NULL THEN  T3Order.T2TEXTCS
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS  NULL  AND  T3Order.T2TEXTRO IS  NULL AND 	 T3Order.T2TEXTCS IS  NULL AND   T3Order.T2TEXTCN  IS NOT NULL THEN 	 T3Order.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  T3Order.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS  NULL  AND  T3Order.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS  NULL  AND  T3Order.T2TEXTRO IS  NULL AND 	 T3Order.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   T3Order.T2TEXTEN  IS  NULL  AND  T3Order.T2TEXTDE  IS  NULL  AND    T3Order.T2TEXTPL IS  NULL  AND  T3Order.T2TEXTSV IS  NULL AND    T3Order.T2TEXTFR IS  NULL 
					AND  T3Order.T2TEXTIT IS  NULL AND   T3Order.T2TEXTES IS  NULL  AND 	 T3Order.T2TEXTRU IS  NULL AND  T3Order.T2TEXTNO IS  NULL  
					AND  T3Order.T2TEXTPT IS  NULL  AND  T3Order.T2TEXTRO IS  NULL AND 	 T3Order.T2TEXTCS IS  NULL AND   T3Order.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T3Order.CREATIONDATE AS  CREATION_DATE
					,T3Order.T2REMARKEN AS  REMARKM
					,CAST('Order' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T3Order.REVISION AS REV_INDEX
					,T3Order.SEQUENCE 
					,T3Order.PROJECTNAME AS RESP
					,T3Order.LIFECYCLESTATE
					,T3Order.FROZENINDICATOR
					,T3Order.SUPERSEDED 
					,T3Order.OFFICIAL
					,T3Order.CHECKEDOUT 
					,T3Order.OWNERNAME
					,T3Order.CURDBNAME
					,T3Order.T2SECURITYSTATE
					,T3Order.OBID AS  CHILD_OBID
					,T3Order.T3ORDERNUMBER AS  CHILD_NAME
					,T3Order.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
			         ,CAST('' AS VARCHAR(275)) AS  QUANTITY
					,CAST('' AS VARCHAR(275)) AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
					,CAST('' AS VARCHAR(275)) AS  WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
					,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T3Order.T3ORDERNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM   GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG  VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T3Order T3Order
			ON   T2MTTOAL.RIGHT1= T3Order.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T3Order'
		     	WHERE VT.CLASS_NM = 'Material';
--Query7
-- Material	 to  ITPlan

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(ITPLAN.PARTNUMBER|| ', ' ||ITPLAN.REVISION|| ', ' ||ITPLAN.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,ITPLAN.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,ITPLAN.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  ITPLAN.T2TEXTEN  IS NOT NULL THEN  ITPLAN.T2TEXTEN
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS NOT NULL THEN   ITPLAN.T2TEXTDE 
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS NOT NULL THEN   ITPLAN.T2TEXTPL
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS NOT NULL THEN  ITPLAN.T2TEXTSV
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS NOT NULL THEN   ITPLAN.T2TEXTFR 
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS NOT NULL THEN  ITPLAN.T2TEXTIT
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS NOT NULL THEN  	 ITPLAN.T2TEXTES				 
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS NOT NULL THEN  ITPLAN.T2TEXTRU
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS NOT NULL THEN 	 ITPLAN.T2TEXTNO
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS NOT NULL THEN 	 ITPLAN.T2TEXTPT
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS  NULL  AND  ITPLAN.T2TEXTRO IS NOT NULL THEN 	 ITPLAN.T2TEXTRO
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS  NULL  AND  ITPLAN.T2TEXTRO IS  NULL AND 	 ITPLAN.T2TEXTCS IS NOT NULL THEN  ITPLAN.T2TEXTCS
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS  NULL  AND  ITPLAN.T2TEXTRO IS  NULL AND 	 ITPLAN.T2TEXTCS IS  NULL AND   ITPLAN.T2TEXTCN  IS NOT NULL THEN 	 ITPLAN.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  ITPLAN.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS  NULL  AND  ITPLAN.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS  NULL  AND  ITPLAN.T2TEXTRO IS  NULL AND 	 ITPLAN.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   ITPLAN.T2TEXTEN  IS  NULL  AND  ITPLAN.T2TEXTDE  IS  NULL  AND    ITPLAN.T2TEXTPL IS  NULL  AND  ITPLAN.T2TEXTSV IS  NULL AND    ITPLAN.T2TEXTFR IS  NULL 
					AND  ITPLAN.T2TEXTIT IS  NULL AND   ITPLAN.T2TEXTES IS  NULL  AND 	 ITPLAN.T2TEXTRU IS  NULL AND  ITPLAN.T2TEXTNO IS  NULL  
					AND  ITPLAN.T2TEXTPT IS  NULL  AND  ITPLAN.T2TEXTRO IS  NULL AND 	 ITPLAN.T2TEXTCS IS  NULL AND   ITPLAN.T2TEXTCN IS NOT NULL THEN 	'CN'
END AS LANGUAGE_CODE
					,ITPLAN.CREATIONDATE AS  CREATION_DATE
					,ITPLAN.T2REMARKEN AS  REMARKM
					,CAST('ITPLAN' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,ITPLAN.REVISION AS REV_INDEX
					,ITPLAN.SEQUENCE 
					,ITPLAN.PROJECTNAME AS RESP
					,ITPLAN.LIFECYCLESTATE
					,ITPLAN.FROZENINDICATOR
					,ITPLAN.SUPERSEDED 
					,ITPLAN.OFFICIAL
					,ITPLAN.CHECKEDOUT 
					,ITPLAN.OWNERNAME
					,ITPLAN.CURDBNAME
					,ITPLAN.T2SECURITYSTATE
					,ITPLAN.OBID AS  CHILD_OBID
					,ITPLAN.PARTNUMBER AS  CHILD_NAME
					,ITPLAN.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
					,T2PTSTPL.T2TEXT9X25EN   AS  POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || ITPLAN.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2TSTPLN  ITPLAN
		 			ON T2MTTOAL.RIGHT1=ITPLAN.OBID AND   T2MTTOAL.CLASS1='T2Matrl' --AND  T2MTTOAL.CLASS2='T2TstPln'
			LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ITEMREV ITEMREV		 
			ON		ITPLAN.OBID=ITEMREV.LEFT1 AND ITEMREV.CLASS1='T2TstPln'
			LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2TpMstr T2TpMstr
			ON T2TpMstr.OBID=ItemRev.LEFT1				    	
		LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2PTSTPL  T2PTSTPL		
		ON T2TpMstr.OBID=T2PTSTPL.RIGHT1	AND T2PTSTPL.CLASS2='T2TpMstr'
		     	WHERE VT.CLASS_NM = 'Material';
-- MATERIAL TO DOC


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)

SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T2STRPUB.PARTNUMBER|| ', ' ||T2STRPUB.REVISION|| ', ' ||T2STRPUB.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T2STRPUB.PARTNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
								,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T2STRPUB.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  T2STRPUB.T2TEXTEN  IS NOT NULL THEN  T2STRPUB.T2TEXTEN
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS NOT NULL THEN   T2STRPUB.T2TEXTDE 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS NOT NULL THEN   T2STRPUB.T2TEXTPL
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS NOT NULL THEN  T2STRPUB.T2TEXTSV
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS NOT NULL THEN   T2STRPUB.T2TEXTFR 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS NOT NULL THEN  T2STRPUB.T2TEXTIT
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS NOT NULL THEN  	 T2STRPUB.T2TEXTES				 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS NOT NULL THEN  T2STRPUB.T2TEXTRU
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS NOT NULL THEN 	 T2STRPUB.T2TEXTNO
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS NOT NULL THEN 	 T2STRPUB.T2TEXTPT
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS NOT NULL THEN 	 T2STRPUB.T2TEXTRO
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS NOT NULL THEN  T2STRPUB.T2TEXTCS
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS  NULL AND   T2STRPUB.T2TEXTCN  IS NOT NULL THEN 	 T2STRPUB.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  T2STRPUB.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   T2STRPUB.T2TEXTEN  IS  NULL  AND  T2STRPUB.T2TEXTDE  IS  NULL  AND    T2STRPUB.T2TEXTPL IS  NULL  AND  T2STRPUB.T2TEXTSV IS  NULL AND    T2STRPUB.T2TEXTFR IS  NULL 
					AND  T2STRPUB.T2TEXTIT IS  NULL AND   T2STRPUB.T2TEXTES IS  NULL  AND 	 T2STRPUB.T2TEXTRU IS  NULL AND  T2STRPUB.T2TEXTNO IS  NULL  
					AND  T2STRPUB.T2TEXTPT IS  NULL  AND  T2STRPUB.T2TEXTRO IS  NULL AND 	 T2STRPUB.T2TEXTCS IS  NULL AND   T2STRPUB.T2TEXTCN IS NOT NULL THEN 	'CN'
END AS LANGUAGE_CODE
					,T2STRPUB.CREATIONDATE AS  CREATION_DATE
					,T2STRPUB.T2REMARKEN AS  REMARKM
					,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T2STRPUB.REVISION AS REV_INDEX
					,T2STRPUB.SEQUENCE 
					,T2STRPUB.PROJECTNAME AS RESP
					,T2STRPUB.LIFECYCLESTATE
					,T2STRPUB.FROZENINDICATOR
					,T2STRPUB.SUPERSEDED 
					,T2STRPUB.OFFICIAL
					,T2STRPUB.CHECKEDOUT 
					,T2STRPUB.OWNERNAME
					,T2STRPUB.CURDBNAME
					,T2STRPUB.T2SECURITYSTATE
					,T2STRPUB.OBID AS  CHILD_OBID
					,T2STRPUB.PARTNUMBER AS  CHILD_NAME
					,T2STRPUB.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
						,CAST('' AS VARCHAR(275)) AS   POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T2STRPUB.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2STRPUB  T2STRPUB
		 			ON T2MTTOAL.RIGHT1=T2STRPUB.OBID AND   T2MTTOAL.CLASS1='T2Matrl' --AND  T2MTTOAL.CLASS2='T2PubStd'
		     	WHERE VT.CLASS_NM = 'Material';	

--MATERIAL TO PRO ORDER

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,T2MATRL.T2MATRLNUMBER
,VT.LVL+1 AS LVL
					,CAST('Contains (has)' AS VARCHAR(30)) AS  REL_TYPE
					,CAST(T3PRDORD.T3ORDERNUMBER|| ', ' ||T3PRDORD.REVISION|| ', ' ||T3PRDORD.SEQUENCE  AS VARCHAR(250)) AS  ITEM_IDNFR
					,T3PRDORD.T3ORDERNUMBER AS T2SPUNUMBER
					,CAST('' AS VARCHAR(275)) AS  FSI_NO
					,CAST('' AS VARCHAR(275)) AS  SUBJECT
						,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM	
--					,T3PRDORD.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  T3PRDORD.T2TEXTEN  IS NOT NULL THEN  T3PRDORD.T2TEXTEN
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS NOT NULL THEN   T3PRDORD.T2TEXTDE 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS NOT NULL THEN   T3PRDORD.T2TEXTPL
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS NOT NULL THEN  T3PRDORD.T2TEXTSV
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS NOT NULL THEN   T3PRDORD.T2TEXTFR 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS NOT NULL THEN  T3PRDORD.T2TEXTIT
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS NOT NULL THEN  	 T3PRDORD.T2TEXTES				 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS NOT NULL THEN  T3PRDORD.T2TEXTRU
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS NOT NULL THEN 	 T3PRDORD.T2TEXTNO
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS NOT NULL THEN 	 T3PRDORD.T2TEXTPT
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS NOT NULL THEN 	 T3PRDORD.T2TEXTRO
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS NOT NULL THEN  T3PRDORD.T2TEXTCS
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS  NULL AND   T3PRDORD.T2TEXTCN  IS NOT NULL THEN 	 T3PRDORD.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  T3PRDORD.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   T3PRDORD.T2TEXTEN  IS  NULL  AND  T3PRDORD.T2TEXTDE  IS  NULL  AND    T3PRDORD.T2TEXTPL IS  NULL  AND  T3PRDORD.T2TEXTSV IS  NULL AND    T3PRDORD.T2TEXTFR IS  NULL 
					AND  T3PRDORD.T2TEXTIT IS  NULL AND   T3PRDORD.T2TEXTES IS  NULL  AND 	 T3PRDORD.T2TEXTRU IS  NULL AND  T3PRDORD.T2TEXTNO IS  NULL  
					AND  T3PRDORD.T2TEXTPT IS  NULL  AND  T3PRDORD.T2TEXTRO IS  NULL AND 	 T3PRDORD.T2TEXTCS IS  NULL AND   T3PRDORD.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
					,T3PRDORD.CREATIONDATE AS  CREATION_DATE
					,T3PRDORD.T2REMARKEN AS  REMARKM
					,CAST('Production Order' AS VARCHAR(30)) AS CLASS_NM
					,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
				,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
				,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
					,T3PRDORD.REVISION AS REV_INDEX
					,T3PRDORD.SEQUENCE 
					,T3PRDORD.PROJECTNAME AS RESP
					,T3PRDORD.LIFECYCLESTATE
					,T3PRDORD.FROZENINDICATOR
					,T3PRDORD.SUPERSEDED 
					,T3PRDORD.OFFICIAL
					,T3PRDORD.CHECKEDOUT 
					,T3PRDORD.OWNERNAME
					,T3PRDORD.CURDBNAME
					,T3PRDORD.T2SECURITYSTATE
					,T3PRDORD.OBID AS  CHILD_OBID
					,T3PRDORD.T3ORDERNUMBER AS  CHILD_NAME
					,T3PRDORD.REVISION AS  CHILD_REV
					 ,CAST('' AS VARCHAR(275)) AS  FSI_KKS
				 	,CAST('' AS VARCHAR(275)) AS QUANTITY
						,CAST('' AS VARCHAR(275)) AS   POSTXT
					,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
					,CAST('' AS VARCHAR(275)) AS  POSITIONNO
				,CAST('' AS VARCHAR(275)) AS WEIGHT
					,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
						,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
					,CAST(VT.DFSORDER || '\' || T3PRDORD.T3ORDERNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  					
			FROM    GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG    VT
			INNER JOIN 	GEEDW_PLP_BULK_V.CDR_RPDM_T2MATRL T2MATRL
					 ON VT.CHILD_OBID=T2MATRL.OBID 
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2MTTOAL T2MTTOAL
					 ON  T2MATRL.OBID =T2MTTOAL.LEFT1 			
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T3PRDORD T3PRDORD
		 			ON T2MTTOAL.RIGHT1=T3PRDORD.OBID AND   T2MTTOAL.CLASS1='T2Matrl' AND  T2MTTOAL.CLASS2='T3PrdOrd'
		     	WHERE VT.CLASS_NM = 'Material';
-- FSI TO DOC

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Use Doc  (Use Doc)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD2 T2FSToD2
	ON T2FSIDoc.OBID =T2FSToD2.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD2.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
			WHERE VT.CLASS_NM = 'FSI';
--- FSI TO DOC

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Subassembly  (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
		INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD6 T2FSToD6
	ON T2FSIDoc.OBID =T2FSToD6.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD6.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';
--Query13
-- FSI to Has Component Doc

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Component (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD5 T2FSToD5
	ON T2FSIDoc.OBID =T2FSToD5.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD5.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';		     	    

--Query13
-- FSI to Has Feedback Doc


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Feedback (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToD3 T2FSToD3
	ON T2FSIDoc.OBID =T2FSToD3.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToD3.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
WHERE VT.CLASS_NM = 'FSI';
--Query14
-- FSI to FSI Specific Doc


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('(I)FSI Specific Doc (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(DOC.PARTNUMBER || ',' || DOC.REVISION || ',' || DOC.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, DOC.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,DOC.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN  DOC.T2TEXTEN
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN   DOC.T2TEXTDE 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN   DOC.T2TEXTPL
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN  DOC.T2TEXTSV
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN   DOC.T2TEXTFR 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN  DOC.T2TEXTIT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	 DOC.T2TEXTES				 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN  DOC.T2TEXTRU
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	 DOC.T2TEXTNO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	 DOC.T2TEXTPT
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 	 DOC.T2TEXTRO
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN  DOC.T2TEXTCS
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN  IS NOT NULL THEN 	 DOC.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  DOC.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   DOC.T2TEXTEN  IS  NULL  AND  DOC.T2TEXTDE  IS  NULL  AND    DOC.T2TEXTPL IS  NULL  AND  DOC.T2TEXTSV IS  NULL AND    DOC.T2TEXTFR IS  NULL 
					AND  DOC.T2TEXTIT IS  NULL AND   DOC.T2TEXTES IS  NULL  AND 	 DOC.T2TEXTRU IS  NULL AND  DOC.T2TEXTNO IS  NULL  
					AND  DOC.T2TEXTPT IS  NULL  AND  DOC.T2TEXTRO IS  NULL AND 	 DOC.T2TEXTCS IS  NULL AND   DOC.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,DOC.CREATIONDATE AS  CREATION_DATE
,DOC.T2REMARKEN AS  REMARKM
,CAST('Document' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,DOC.REVISION AS REV_INDEX
,DOC.SEQUENCE 
,DOC.PROJECTNAME 
,DOC.LIFECYCLESTATE
,DOC.FROZENINDICATOR
,DOC.SUPERSEDED 
,DOC.OFFICIAL
,DOC.CHECKEDOUT 
,DOC.OWNERNAME
,DOC.CURDBNAME
,DOC.T2SECURITYSTATE
,DOC.OBID AS  CHILD_OBID
,DOC.PARTNUMBER AS  CHILD_NAME
,DOC.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,CAST('' AS VARCHAR(275)) AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,CAST('' AS VARCHAR(275)) AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,CAST('' AS VARCHAR(275)) AS  WEIGHT
,CAST('' AS VARCHAR(275)) AS  UNITOFMEASURE 
,DOC.DOCUMENTTYPE AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || DOC.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToDc T2FSToDc
	ON T2FSIDoc.OBID =T2FSToDc.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2strpub DOC
	ON 	T2FSToDc.RIGHT1=DOC.OBID --AND DOC.SUPERSEDED = '-'
			WHERE VT.CLASS_NM = 'FSI';
--Query15
-- FSI to Has Subassembly PART

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Subassembly (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(PART.PARTNUMBER || ',' || PART.REVISION || ',' || PART.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, PART.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,PART.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN  PART.T2TEXTEN
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN   PART.T2TEXTDE 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN   PART.T2TEXTPL
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN  PART.T2TEXTSV
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN   PART.T2TEXTFR 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN  PART.T2TEXTIT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	 PART.T2TEXTES				 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN  PART.T2TEXTRU
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	 PART.T2TEXTNO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	 PART.T2TEXTPT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 	 PART.T2TEXTRO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN  PART.T2TEXTCS
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN  IS NOT NULL THEN 	 PART.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,PART.CREATIONDATE AS  CREATION_DATE
,PART.T2REMARKEN AS  REMARKM
,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,PART.REVISION AS REV_INDEX
,PART.SEQUENCE 
,PART.PROJECTNAME 
,PART.LIFECYCLESTATE
,PART.FROZENINDICATOR
,PART.SUPERSEDED 
,PART.OFFICIAL
,PART.CHECKEDOUT 
,PART.OWNERNAME
,PART.CURDBNAME
,PART.T2SECURITYSTATE
,PART.OBID AS  CHILD_OBID
,PART.PARTNUMBER AS  CHILD_NAME
,PART.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,ASSMSTRC.QUANTITY AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,PART.T2WEIGHTSTR AS  WEIGHT
,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || PART.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToP6 T2FSToP6
	ON T2FSIDoc.OBID =T2FSToP6.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2Assm PART
	ON 	T2FSToP6.RIGHT1=PART.OBID --AND PART.SUPERSEDED = '-'
	LEFT OUTER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
ON PART.OBID = ASSMSTRC.LEFT1
WHERE VT.CLASS_NM = 'FSI';

--Query16
-- FSI to Has Component PART


INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT DISTINCT
VT.SYSTEM_ID
,VT.SYSTEM_NM
,SUBSTR(T2FSIDoc.T2FSIDOCNUMBER,1,8) 
,VT.LVL+1 AS LVL
	,CAST('Has Component (has)' AS VARCHAR(30)) AS  REL_TYPE
	,CAST(PART.PARTNUMBER || ',' || PART.REVISION || ',' || PART.SEQUENCE   AS VARCHAR(250)) AS  ITEM_IDNFR
	, PART.PARTNUMBER
	,CAST('' AS VARCHAR(275)) AS T2POSEIDONNUMBER
,CAST('' AS VARCHAR(275)) AS  SUBJECT
,CAST('' AS VARCHAR(275)) AS  PARENT_TEXTM
--,PART.T2TEXTEN AS  TEXTM
	,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN  PART.T2TEXTEN
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN   PART.T2TEXTDE 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN   PART.T2TEXTPL
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN  PART.T2TEXTSV
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN   PART.T2TEXTFR 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN  PART.T2TEXTIT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	 PART.T2TEXTES				 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN  PART.T2TEXTRU
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	 PART.T2TEXTNO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	 PART.T2TEXTPT
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 	 PART.T2TEXTRO
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN  PART.T2TEXTCS
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN  IS NOT NULL THEN 	 PART.T2TEXTCN															
					END AS TEXTM
					,CASE 
					WHEN  PART.T2TEXTEN  IS NOT NULL THEN 'EN'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS NOT NULL THEN  'DE'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS NOT NULL THEN  'PL'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS NOT NULL THEN 'SV'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS NOT NULL THEN  'FR'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS NOT NULL THEN 'IT' 
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS NOT NULL THEN  	'ES'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS NOT NULL THEN 'RU'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS NOT NULL THEN 	'NO'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS NOT NULL THEN 	'PT'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS NOT NULL THEN 'RO'	
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS NOT NULL THEN 'CS'
					WHEN   PART.T2TEXTEN  IS  NULL  AND  PART.T2TEXTDE  IS  NULL  AND    PART.T2TEXTPL IS  NULL  AND  PART.T2TEXTSV IS  NULL AND    PART.T2TEXTFR IS  NULL 
					AND  PART.T2TEXTIT IS  NULL AND   PART.T2TEXTES IS  NULL  AND 	 PART.T2TEXTRU IS  NULL AND  PART.T2TEXTNO IS  NULL  
					AND  PART.T2TEXTPT IS  NULL  AND  PART.T2TEXTRO IS  NULL AND 	 PART.T2TEXTCS IS  NULL AND   PART.T2TEXTCN IS NOT NULL THEN 	'CN'
					END AS LANGUAGE_CODE
,PART.CREATIONDATE AS  CREATION_DATE
,PART.T2REMARKEN AS  REMARKM
,CAST('Part' AS VARCHAR(30)) AS CLASS_NM
,CAST('' AS VARCHAR(275)) AS  T2SERIALNUMBER -- Serial No
,CAST('' AS VARCHAR(275)) AS T2STOREORDERNUMBER-- Order No
,CAST('' AS VARCHAR(275)) AS T2SYSTEMCODE --System Code
,PART.REVISION AS REV_INDEX
,PART.SEQUENCE 
,PART.PROJECTNAME 
,PART.LIFECYCLESTATE
,PART.FROZENINDICATOR
,PART.SUPERSEDED 
,PART.OFFICIAL
,PART.CHECKEDOUT 
,PART.OWNERNAME
,PART.CURDBNAME
,PART.T2SECURITYSTATE
,PART.OBID AS  CHILD_OBID
,PART.PARTNUMBER AS  CHILD_NAME
,PART.REVISION AS  CHILD_REV
,CAST('' AS VARCHAR(275)) AS  FSI_KKS
,ASSMSTRC.QUANTITY AS  QUANTITY
,CAST('' AS VARCHAR(275)) AS  POSTXT
,ASSMSTRC.FINDNUMBER AS  FINDNUMBER
,CAST('' AS VARCHAR(275)) AS  POSITIONNO
,PART.T2WEIGHTSTR AS  WEIGHT
,ASSMSTRC.UNITOFMEASURE AS  UNITOFMEASURE 
,CAST('' AS VARCHAR(275)) AS  DOCUMENTTYPE
,CAST(VT.DFSORDER || '\' || PART.PARTNUMBER AS VARCHAR(500))  AS  DFSORDER,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS')  AS DW_LOAD_DTTM,
 'CDR' AS DW_CREATED_BY,
 CAST(current_timestamp(0 )AS timestamp(0) FORMAT 'MM/DD/YYYYBHH:MI:SS') AS DW_UPDATED_DTTM,
'CDR'    AS DW_UPDATED_BY  
	FROM     GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG   VT
			INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2FSIDoc T2FSIDoc
	ON VT.CHILD_OBID=T2FSIDoc.OBID 
	INNER JOIN   GEEDW_PLP_BULK_V.CDR_RPDM_T2FSToP5 T2FSToP5
	ON T2FSIDoc.OBID =T2FSToP5.LEFT1
	INNER JOIN GEEDW_PLP_BULK_V.CDR_RPDM_T2Assm PART
	ON 	T2FSToP5.RIGHT1=PART.OBID --AND PART.SUPERSEDED = '-'
	LEFT OUTER JOIN  GEEDW_PLP_BULK_V.CDR_RPDM_ASSMSTRC ASSMSTRC 
ON PART.OBID = ASSMSTRC.LEFT1
WHERE VT.CLASS_NM = 'FSI';

---------------------=============INSERT eVENT ST into MT_MBOM_SYS_table
-----------Delete Event structure for ST,GT & TG
DELETE FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSBOM_ALL_LEVELS
WHERE REL_TYPE  NOT LIKE '%INSTANCES%';

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSBOM_ALL_LEVELS
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_ST;
------------------------ load GT event data into MT_SYSMBOM table--=============

INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSBOM_ALL_LEVELS
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_GT;
---------------------------- load TG event data into MT_SYSMBOM table--=============
INSERT INTO GEEDW_PLP_BULK_T.MT_RPDM_SYSBOM_ALL_LEVELS
(
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
)
SELECT
SYSTEM_ID,
SYSTEM_NM,
PARENT_NM,
LVL,
REL_TYPE,
ITEM_IDNFR,
T2SPUNUMBER,
T2POSEIDONNUMBER,
SUBJECT,
PARENT_TEXTM,
TEXTM,
LANGUAGE_CODE,
CREATION_DATE,
REMARKM,
CLASS_NM,
T2SERIALNUMBER,
T2STOREORDERNUMBER,
T2SYSTEMCODE,
REV_INDEX,
SEQUENCE,
PROJECTNAME,
LIFECYCLESTATE,
FROZENINDICATOR,
SUPERSEDED,
OFFICIAL,
CHECKEDOUT,
OWNERNAME,
CURDBNAME,
T2SECURITYSTATE,
CHILD_OBID,
CHILD_NAME,
CHILD_REV,
FSI_KKS,
QUANTITY,
POSTXT,
FINDNUMBER,
POSITIONNO,
WEIGHT,
UNITOFMEASURE ,
DOCUMENTTYPE,
DFSORDER,
DW_LOAD_DTTM ,
DW_CREATED_BY ,
DW_UPDATED_DTTM,
DW_UPDATED_BY  
FROM GEEDW_PLP_BULK_T.MT_RPDM_SYSTEM_PDM_TG;

.LOGOFF
.EXIT 0
EOF

bteqexitcode=$?
echo "Exited With errorcode $bteqexitcode"
exit $bteqexitcode